import './polyfills.server.mjs';
import{$ as Rn,A as Ft,B as ie,Ba as de,C as P,Ca as $n,D as kn,Da as zn,E as O,Ea as Jn,F as ui,G as p,H as g,I as X,J as On,K as J,L as ge,M as _,N as ue,O as Tn,P as Dn,Q as An,R as Mn,S as Oe,T as he,U as Fn,V as Vn,X as Nn,a as cr,b as vn,ba as In,c as Cn,d as bn,da as hi,e as ur,ea as Vt,f as En,fa as Te,g as wn,ga as Pn,h as hr,ha as di,i as Se,j as le,ja as Ln,k as kt,ka as Ze,l as me,la as De,m as je,ma as dr,n as ke,na as fi,o as ce,oa as Bn,p as Ot,pa as Un,q as H,qa as jn,r as Tt,ra as qn,s as xn,t as Sn,u as Dt,ua as Gn,v as Qe,w as At,x as C,y as v,ya as Hn,z as Mt,za as Wn}from"./chunk-RKZDO36O.mjs";import{a as k,b as N,c as S,e as M,f as qa,g as U}from"./chunk-5XUXGTUW.mjs";var Vs=M((Ih,Fs)=>{"use strict";var ct=S("fs"),Ms=S("url"),Tl=S("child_process").spawn;Fs.exports=Di;Di.XMLHttpRequest=Di;function Di(r){"use strict";r=r||{};var t=this,e=S("http"),i=S("https"),n,s,o={},a=!1,l={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},u=Object.assign({},l),c=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],h=["TRACE","TRACK","CONNECT"],f=!1,E=!1,x=!1,m={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),this.status=null,this.statusText=null;var w=function(d){return a||d&&c.indexOf(d.toLowerCase())===-1},q=function(d){return d&&h.indexOf(d)===-1};this.open=function(d,y,G,I,Y){if(this.abort(),E=!1,x=!1,!q(d))throw new Error("SecurityError: Request method not allowed");o={method:d,url:y.toString(),async:typeof G!="boolean"?!0:G,user:I||null,password:Y||null},V(this.OPENED)},this.setDisableHeaderCheck=function(d){a=d},this.setRequestHeader=function(d,y){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!w(d))return console.warn('Refused to set unsafe header "'+d+'"'),!1;if(f)throw new Error("INVALID_STATE_ERR: send flag is true");return u[d]=y,!0},this.getResponseHeader=function(d){return typeof d=="string"&&this.readyState>this.OPENED&&s.headers[d.toLowerCase()]&&!E?s.headers[d.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||E)return"";var d="";for(var y in s.headers)y!=="set-cookie"&&y!=="set-cookie2"&&(d+=y+": "+s.headers[y]+`\r
`);return d.substr(0,d.length-2)},this.getRequestHeader=function(d){return typeof d=="string"&&u[d]?u[d]:""},this.send=function(d){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(f)throw new Error("INVALID_STATE_ERR: send has already been called");var y=!1,G=!1,I=Ms.parse(o.url),Y;switch(I.protocol){case"https:":y=!0;case"http:":Y=I.hostname;break;case"file:":G=!0;break;case void 0:case"":Y="localhost";break;default:throw new Error("Protocol not supported.")}if(G){if(o.method!=="GET")throw new Error("XMLHttpRequest: Only GET method is supported");if(o.async)ct.readFile(unescape(I.pathname),function($,Ue){$?t.handleError($,$.errno||-1):(t.status=200,t.responseText=Ue.toString("utf8"),t.response=Ue,V(t.DONE))});else try{this.response=ct.readFileSync(unescape(I.pathname)),this.responseText=this.response.toString("utf8"),this.status=200,V(t.DONE)}catch($){this.handleError($,$.errno||-1)}return}var pe=I.port||(y?443:80),Be=I.pathname+(I.search?I.search:"");if(u.Host=Y,y&&pe===443||pe===80||(u.Host+=":"+I.port),o.user){typeof o.password>"u"&&(o.password="");var si=new Buffer(o.user+":"+o.password);u.Authorization="Basic "+si.toString("base64")}if(o.method==="GET"||o.method==="HEAD")d=null;else if(d){u["Content-Length"]=Buffer.isBuffer(d)?d.length:Buffer.byteLength(d);var Ia=Object.keys(u);Ia.some(function($){return $.toLowerCase()==="content-type"})||(u["Content-Type"]="text/plain;charset=UTF-8")}else o.method==="POST"&&(u["Content-Length"]=0);var Pa=r.agent||!1,ae={host:Y,port:pe,path:Be,method:o.method,headers:u,agent:Pa};if(y&&(ae.pfx=r.pfx,ae.key=r.key,ae.passphrase=r.passphrase,ae.cert=r.cert,ae.ca=r.ca,ae.ciphers=r.ciphers,ae.rejectUnauthorized=r.rejectUnauthorized!==!1),E=!1,o.async){var oi=y?i.request:e.request;f=!0,t.dispatchEvent("readystatechange");var ai=function($){if(s=$,s.statusCode===302||s.statusCode===303||s.statusCode===307){o.url=s.headers.location;var Ue=Ms.parse(o.url);Y=Ue.hostname;var xe={hostname:Ue.hostname,port:Ue.port,path:Ue.path,method:s.statusCode===303?"GET":o.method,headers:u};y&&(xe.pfx=r.pfx,xe.key=r.key,xe.passphrase=r.passphrase,xe.cert=r.cert,xe.ca=r.ca,xe.ciphers=r.ciphers,xe.rejectUnauthorized=r.rejectUnauthorized!==!1),n=oi(xe,ai).on("error",li),n.end();return}V(t.HEADERS_RECEIVED),t.status=s.statusCode,s.on("data",function(lr){if(lr){var ja=Buffer.from(lr);t.response=Buffer.concat([t.response,ja])}f&&V(t.LOADING)}),s.on("end",function(){f&&(f=!1,V(t.DONE),t.responseText=t.response.toString("utf8"))}),s.on("error",function(lr){t.handleError(lr)})},li=function($){if(n.reusedSocket&&$.code==="ECONNRESET")return oi(ae,ai).on("error",li);t.handleError($)};n=oi(ae,ai).on("error",li),r.autoUnref&&n.on("socket",$=>{$.unref()}),d&&n.write(d),n.end(),t.dispatchEvent("loadstart")}else{var xt=".node-xmlhttprequest-content-"+process.pid,St=".node-xmlhttprequest-sync-"+process.pid;ct.writeFileSync(St,"","utf8");for(var La="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(y?"s":"")+".request;var options = "+JSON.stringify(ae)+";var responseText = '';var responseData = Buffer.alloc(0);var req = doRequest(options, function(response) {response.on('data', function(chunk) {  var data = Buffer.from(chunk);  responseText += data.toString('utf8');  responseData = Buffer.concat([responseData, data]);});response.on('end', function() {fs.writeFileSync('"+xt+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText, data: responseData.toString('base64')}}), 'utf8');fs.unlinkSync('"+St+"');});response.on('error', function(error) {fs.writeFileSync('"+xt+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+St+"');});}).on('error', function(error) {fs.writeFileSync('"+xt+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+St+"');});"+(d?"req.write('"+JSON.stringify(d).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",Ba=Tl(process.argv[0],["-e",La]),Qu;ct.existsSync(St););if(t.responseText=ct.readFileSync(xt,"utf8"),Ba.stdin.end(),ct.unlinkSync(xt),t.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var Ua=JSON.parse(t.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,""));t.handleError(Ua,503)}else{t.status=t.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1");var ci=JSON.parse(t.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"));s={statusCode:t.status,headers:ci.data.headers},t.responseText=ci.data.text,t.response=Buffer.from(ci.data.data,"base64"),V(t.DONE,!0)}}},this.handleError=function(d,y){this.status=y||0,this.statusText=d,this.responseText=d.stack,E=!0,V(this.DONE)},this.abort=function(){n&&(n.abort(),n=null),u=Object.assign({},l),this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),E=x=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||f)&&this.readyState!==this.DONE&&(f=!1,V(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(d,y){d in m||(m[d]=[]),m[d].push(y)},this.removeEventListener=function(d,y){d in m&&(m[d]=m[d].filter(function(G){return G!==y}))},this.dispatchEvent=function(d){if(typeof t["on"+d]=="function"&&(this.readyState===this.DONE&&o.async?setTimeout(function(){t["on"+d]()},0):t["on"+d]()),d in m)for(let y=0,G=m[d].length;y<G;y++)this.readyState===this.DONE?setTimeout(function(){m[d][y].call(t)},0):m[d][y].call(t)};var V=function(d){if(!(t.readyState===d||t.readyState===t.UNSENT&&x)&&(t.readyState=d,(o.async||t.readyState<t.OPENED||t.readyState===t.DONE)&&t.dispatchEvent("readystatechange"),t.readyState===t.DONE)){let y;x?y="abort":E?y="error":y="load",t.dispatchEvent(y),t.dispatchEvent("loadend")}}}});var Js=M((Kh,zs)=>{"use strict";var ut=1e3,ht=ut*60,dt=ht*60,$e=dt*24,Rl=$e*7,Il=$e*365.25;zs.exports=function(r,t){t=t||{};var e=typeof r;if(e==="string"&&r.length>0)return Pl(r);if(e==="number"&&isFinite(r))return t.long?Bl(r):Ll(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function Pl(r){if(r=String(r),!(r.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(t){var e=parseFloat(t[1]),i=(t[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return e*Il;case"weeks":case"week":case"w":return e*Rl;case"days":case"day":case"d":return e*$e;case"hours":case"hour":case"hrs":case"hr":case"h":return e*dt;case"minutes":case"minute":case"mins":case"min":case"m":return e*ht;case"seconds":case"second":case"secs":case"sec":case"s":return e*ut;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}function Ll(r){var t=Math.abs(r);return t>=$e?Math.round(r/$e)+"d":t>=dt?Math.round(r/dt)+"h":t>=ht?Math.round(r/ht)+"m":t>=ut?Math.round(r/ut)+"s":r+"ms"}function Bl(r){var t=Math.abs(r);return t>=$e?Rr(r,t,$e,"day"):t>=dt?Rr(r,t,dt,"hour"):t>=ht?Rr(r,t,ht,"minute"):t>=ut?Rr(r,t,ut,"second"):r+" ms"}function Rr(r,t,e,i){var n=t>=e*1.5;return Math.round(r/e)+" "+i+(n?"s":"")}});var Ni=M((Qh,Ys)=>{"use strict";function Ul(r){e.debug=e,e.default=e,e.coerce=l,e.disable=s,e.enable=n,e.enabled=o,e.humanize=Js(),e.destroy=u,Object.keys(r).forEach(c=>{e[c]=r[c]}),e.names=[],e.skips=[],e.formatters={};function t(c){let h=0;for(let f=0;f<c.length;f++)h=(h<<5)-h+c.charCodeAt(f),h|=0;return e.colors[Math.abs(h)%e.colors.length]}e.selectColor=t;function e(c){let h,f=null,E,x;function m(...w){if(!m.enabled)return;let q=m,V=Number(new Date),d=V-(h||V);q.diff=d,q.prev=h,q.curr=V,h=V,w[0]=e.coerce(w[0]),typeof w[0]!="string"&&w.unshift("%O");let y=0;w[0]=w[0].replace(/%([a-zA-Z%])/g,(I,Y)=>{if(I==="%%")return"%";y++;let pe=e.formatters[Y];if(typeof pe=="function"){let Be=w[y];I=pe.call(q,Be),w.splice(y,1),y--}return I}),e.formatArgs.call(q,w),(q.log||e.log).apply(q,w)}return m.namespace=c,m.useColors=e.useColors(),m.color=e.selectColor(c),m.extend=i,m.destroy=e.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(E!==e.namespaces&&(E=e.namespaces,x=e.enabled(c)),x),set:w=>{f=w}}),typeof e.init=="function"&&e.init(m),m}function i(c,h){let f=e(this.namespace+(typeof h>"u"?":":h)+c);return f.log=this.log,f}function n(c){e.save(c),e.namespaces=c,e.names=[],e.skips=[];let h,f=(typeof c=="string"?c:"").split(/[\s,]+/),E=f.length;for(h=0;h<E;h++)f[h]&&(c=f[h].replace(/\*/g,".*?"),c[0]==="-"?e.skips.push(new RegExp("^"+c.slice(1)+"$")):e.names.push(new RegExp("^"+c+"$")))}function s(){let c=[...e.names.map(a),...e.skips.map(a).map(h=>"-"+h)].join(",");return e.enable(""),c}function o(c){if(c[c.length-1]==="*")return!0;let h,f;for(h=0,f=e.skips.length;h<f;h++)if(e.skips[h].test(c))return!1;for(h=0,f=e.names.length;h<f;h++)if(e.names[h].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function l(c){return c instanceof Error?c.stack||c.message:c}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}Ys.exports=Ul});var Xs=M((K,Ir)=>{"use strict";K.formatArgs=ql;K.save=Gl;K.load=Hl;K.useColors=jl;K.storage=Wl();K.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();K.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function jl(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function ql(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+Ir.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;r.splice(1,0,t,"color: inherit");let e=0,i=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(e++,n==="%c"&&(i=e))}),r.splice(i,0,t)}K.log=console.debug||console.log||(()=>{});function Gl(r){try{r?K.storage.setItem("debug",r):K.storage.removeItem("debug")}catch{}}function Hl(){let r;try{r=K.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function Wl(){try{return localStorage}catch{}}Ir.exports=Ni()(K);var{formatters:$l}=Ir.exports;$l.j=function(r){try{return JSON.stringify(r)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var Qs=M((Zh,Ks)=>{"use strict";Ks.exports=(r,t=process.argv)=>{let e=r.startsWith("-")?"":r.length===1?"-":"--",i=t.indexOf(e+r),n=t.indexOf("--");return i!==-1&&(n===-1||i<n)}});var to=M((ed,eo)=>{"use strict";var zl=S("os"),Zs=S("tty"),ee=Qs(),{env:L}=process,Re;ee("no-color")||ee("no-colors")||ee("color=false")||ee("color=never")?Re=0:(ee("color")||ee("colors")||ee("color=true")||ee("color=always"))&&(Re=1);"FORCE_COLOR"in L&&(L.FORCE_COLOR==="true"?Re=1:L.FORCE_COLOR==="false"?Re=0:Re=L.FORCE_COLOR.length===0?1:Math.min(parseInt(L.FORCE_COLOR,10),3));function Ri(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function Ii(r,t){if(Re===0)return 0;if(ee("color=16m")||ee("color=full")||ee("color=truecolor"))return 3;if(ee("color=256"))return 2;if(r&&!t&&Re===void 0)return 0;let e=Re||0;if(L.TERM==="dumb")return e;if(process.platform==="win32"){let i=zl.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in L)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(i=>i in L)||L.CI_NAME==="codeship"?1:e;if("TEAMCITY_VERSION"in L)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(L.TEAMCITY_VERSION)?1:0;if(L.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in L){let i=parseInt((L.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(L.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(L.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(L.TERM)||"COLORTERM"in L?1:e}function Jl(r){let t=Ii(r,r&&r.isTTY);return Ri(t)}eo.exports={supportsColor:Jl,stdout:Ri(Ii(!0,Zs.isatty(1))),stderr:Ri(Ii(!0,Zs.isatty(2)))}});var io=M((B,Lr)=>{"use strict";var Yl=S("tty"),Pr=S("util");B.init=rc;B.log=Zl;B.formatArgs=Kl;B.save=ec;B.load=tc;B.useColors=Xl;B.destroy=Pr.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");B.colors=[6,2,3,4,5,1];try{let r=to();r&&(r.stderr||r).level>=2&&(B.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}B.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,t)=>{let e=t.substring(6).toLowerCase().replace(/_([a-z])/g,(n,s)=>s.toUpperCase()),i=process.env[t];return/^(yes|on|true|enabled)$/i.test(i)?i=!0:/^(no|off|false|disabled)$/i.test(i)?i=!1:i==="null"?i=null:i=Number(i),r[e]=i,r},{});function Xl(){return"colors"in B.inspectOpts?!!B.inspectOpts.colors:Yl.isatty(process.stderr.fd)}function Kl(r){let{namespace:t,useColors:e}=this;if(e){let i=this.color,n="\x1B[3"+(i<8?i:"8;5;"+i),s=`  ${n};1m${t} \x1B[0m`;r[0]=s+r[0].split(`
`).join(`
`+s),r.push(n+"m+"+Lr.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=Ql()+t+" "+r[0]}function Ql(){return B.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Zl(...r){return process.stderr.write(Pr.formatWithOptions(B.inspectOpts,...r)+`
`)}function ec(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function tc(){return process.env.DEBUG}function rc(r){r.inspectOpts={};let t=Object.keys(B.inspectOpts);for(let e=0;e<t.length;e++)r.inspectOpts[t[e]]=B.inspectOpts[t[e]]}Lr.exports=Ni()(B);var{formatters:ro}=Lr.exports;ro.o=function(r){return this.inspectOpts.colors=this.useColors,Pr.inspect(r,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};ro.O=function(r){return this.inspectOpts.colors=this.useColors,Pr.inspect(r,this.inspectOpts)}});var te=M((td,Pi)=>{"use strict";typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Pi.exports=Xs():Pi.exports=io()});var po=M((bd,fo)=>{"use strict";var{Duplex:ac}=S("stream");function uo(r){r.emit("close")}function lc(){!this.destroyed&&this._writableState.finished&&this.destroy()}function ho(r){this.removeListener("error",ho),this.destroy(),this.listenerCount("error")===0&&this.emit("error",r)}function cc(r,t){let e=!0,i=new ac(N(k({},t),{autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1}));return r.on("message",function(s,o){let a=!o&&i._readableState.objectMode?s.toString():s;i.push(a)||r.pause()}),r.once("error",function(s){i.destroyed||(e=!1,i.destroy(s))}),r.once("close",function(){i.destroyed||i.push(null)}),i._destroy=function(n,s){if(r.readyState===r.CLOSED){s(n),process.nextTick(uo,i);return}let o=!1;r.once("error",function(l){o=!0,s(l)}),r.once("close",function(){o||s(n),process.nextTick(uo,i)}),e&&r.terminate()},i._final=function(n){if(r.readyState===r.CONNECTING){r.once("open",function(){i._final(n)});return}r._socket!==null&&(r._socket._writableState.finished?(n(),i._readableState.endEmitted&&i.destroy()):(r._socket.once("finish",function(){n()}),r.close()))},i._read=function(){r.isPaused&&r.resume()},i._write=function(n,s,o){if(r.readyState===r.CONNECTING){r.once("open",function(){i._write(n,s,o)});return}r.send(n,o)},i.on("end",lc),i.on("error",ho),i}fo.exports=cc});var Ie=M((wd,mo)=>{"use strict";mo.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var $t=M((xd,jr)=>{"use strict";var{EMPTY_BUFFER:uc}=Ie(),Ui=Buffer[Symbol.species];function hc(r,t){if(r.length===0)return uc;if(r.length===1)return r[0];let e=Buffer.allocUnsafe(t),i=0;for(let n=0;n<r.length;n++){let s=r[n];e.set(s,i),i+=s.length}return i<t?new Ui(e.buffer,e.byteOffset,i):e}function go(r,t,e,i,n){for(let s=0;s<n;s++)e[i+s]=r[s]^t[s&3]}function _o(r,t){for(let e=0;e<r.length;e++)r[e]^=t[e&3]}function dc(r){return r.length===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.length)}function ji(r){if(ji.readOnly=!0,Buffer.isBuffer(r))return r;let t;return r instanceof ArrayBuffer?t=new Ui(r):ArrayBuffer.isView(r)?t=new Ui(r.buffer,r.byteOffset,r.byteLength):(t=Buffer.from(r),ji.readOnly=!1),t}jr.exports={concat:hc,mask:go,toArrayBuffer:dc,toBuffer:ji,unmask:_o};if(!process.env.WS_NO_BUFFER_UTIL)try{let r=S("bufferutil");jr.exports.mask=function(t,e,i,n,s){s<48?go(t,e,i,n,s):r.mask(t,e,i,n,s)},jr.exports.unmask=function(t,e){t.length<32?_o(t,e):r.unmask(t,e)}}catch{}});var Co=M((Sd,vo)=>{"use strict";var yo=Symbol("kDone"),qi=Symbol("kRun"),Gi=class{constructor(t){this[yo]=()=>{this.pending--,this[qi]()},this.concurrency=t||1/0,this.jobs=[],this.pending=0}add(t){this.jobs.push(t),this[qi]()}[qi](){if(this.pending!==this.concurrency&&this.jobs.length){let t=this.jobs.shift();this.pending++,t(this[yo])}}};vo.exports=Gi});var Yt=M((kd,xo)=>{"use strict";var zt=S("zlib"),bo=$t(),fc=Co(),{kStatusCode:Eo}=Ie(),pc=Buffer[Symbol.species],mc=Buffer.from([0,0,255,255]),Hr=Symbol("permessage-deflate"),be=Symbol("total-length"),Jt=Symbol("callback"),Pe=Symbol("buffers"),Gr=Symbol("error"),qr,Hi=class{constructor(t,e,i){if(this._maxPayload=i|0,this._options=t||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!e,this._deflate=null,this._inflate=null,this.params=null,!qr){let n=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;qr=new fc(n)}}static get extensionName(){return"permessage-deflate"}offer(){let t={};return this._options.serverNoContextTakeover&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(t.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(t.client_max_window_bits=!0),t}accept(t){return t=this.normalizeParams(t),this.params=this._isServer?this.acceptAsServer(t):this.acceptAsClient(t),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let t=this._deflate[Jt];this._deflate.close(),this._deflate=null,t&&t(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(t){let e=this._options,i=t.find(n=>!(e.serverNoContextTakeover===!1&&n.server_no_context_takeover||n.server_max_window_bits&&(e.serverMaxWindowBits===!1||typeof e.serverMaxWindowBits=="number"&&e.serverMaxWindowBits>n.server_max_window_bits)||typeof e.clientMaxWindowBits=="number"&&!n.client_max_window_bits));if(!i)throw new Error("None of the extension offers can be accepted");return e.serverNoContextTakeover&&(i.server_no_context_takeover=!0),e.clientNoContextTakeover&&(i.client_no_context_takeover=!0),typeof e.serverMaxWindowBits=="number"&&(i.server_max_window_bits=e.serverMaxWindowBits),typeof e.clientMaxWindowBits=="number"?i.client_max_window_bits=e.clientMaxWindowBits:(i.client_max_window_bits===!0||e.clientMaxWindowBits===!1)&&delete i.client_max_window_bits,i}acceptAsClient(t){let e=t[0];if(this._options.clientNoContextTakeover===!1&&e.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!e.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(e.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&e.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return e}normalizeParams(t){return t.forEach(e=>{Object.keys(e).forEach(i=>{let n=e[i];if(n.length>1)throw new Error(`Parameter "${i}" must have only a single value`);if(n=n[0],i==="client_max_window_bits"){if(n!==!0){let s=+n;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${i}": ${n}`);n=s}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${i}": ${n}`)}else if(i==="server_max_window_bits"){let s=+n;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${i}": ${n}`);n=s}else if(i==="client_no_context_takeover"||i==="server_no_context_takeover"){if(n!==!0)throw new TypeError(`Invalid value for parameter "${i}": ${n}`)}else throw new Error(`Unknown parameter "${i}"`);e[i]=n})}),t}decompress(t,e,i){qr.add(n=>{this._decompress(t,e,(s,o)=>{n(),i(s,o)})})}compress(t,e,i){qr.add(n=>{this._compress(t,e,(s,o)=>{n(),i(s,o)})})}_decompress(t,e,i){let n=this._isServer?"client":"server";if(!this._inflate){let s=`${n}_max_window_bits`,o=typeof this.params[s]!="number"?zt.Z_DEFAULT_WINDOWBITS:this.params[s];this._inflate=zt.createInflateRaw(N(k({},this._options.zlibInflateOptions),{windowBits:o})),this._inflate[Hr]=this,this._inflate[be]=0,this._inflate[Pe]=[],this._inflate.on("error",_c),this._inflate.on("data",wo)}this._inflate[Jt]=i,this._inflate.write(t),e&&this._inflate.write(mc),this._inflate.flush(()=>{let s=this._inflate[Gr];if(s){this._inflate.close(),this._inflate=null,i(s);return}let o=bo.concat(this._inflate[Pe],this._inflate[be]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[be]=0,this._inflate[Pe]=[],e&&this.params[`${n}_no_context_takeover`]&&this._inflate.reset()),i(null,o)})}_compress(t,e,i){let n=this._isServer?"server":"client";if(!this._deflate){let s=`${n}_max_window_bits`,o=typeof this.params[s]!="number"?zt.Z_DEFAULT_WINDOWBITS:this.params[s];this._deflate=zt.createDeflateRaw(N(k({},this._options.zlibDeflateOptions),{windowBits:o})),this._deflate[be]=0,this._deflate[Pe]=[],this._deflate.on("data",gc)}this._deflate[Jt]=i,this._deflate.write(t),this._deflate.flush(zt.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let s=bo.concat(this._deflate[Pe],this._deflate[be]);e&&(s=new pc(s.buffer,s.byteOffset,s.length-4)),this._deflate[Jt]=null,this._deflate[be]=0,this._deflate[Pe]=[],e&&this.params[`${n}_no_context_takeover`]&&this._deflate.reset(),i(null,s)})}};xo.exports=Hi;function gc(r){this[Pe].push(r),this[be]+=r.length}function wo(r){if(this[be]+=r.length,this[Hr]._maxPayload<1||this[be]<=this[Hr]._maxPayload){this[Pe].push(r);return}this[Gr]=new RangeError("Max payload size exceeded"),this[Gr].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Gr][Eo]=1009,this.removeListener("data",wo),this.reset()}function _c(r){this[Hr]._inflate=null,r[Eo]=1007,this[Jt](r)}});var Xt=M((Td,Wr)=>{"use strict";var{isUtf8:So}=S("buffer"),yc=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function vc(r){return r>=1e3&&r<=1014&&r!==1004&&r!==1005&&r!==1006||r>=3e3&&r<=4999}function Wi(r){let t=r.length,e=0;for(;e<t;)if(!(r[e]&128))e++;else if((r[e]&224)===192){if(e+1===t||(r[e+1]&192)!==128||(r[e]&254)===192)return!1;e+=2}else if((r[e]&240)===224){if(e+2>=t||(r[e+1]&192)!==128||(r[e+2]&192)!==128||r[e]===224&&(r[e+1]&224)===128||r[e]===237&&(r[e+1]&224)===160)return!1;e+=3}else if((r[e]&248)===240){if(e+3>=t||(r[e+1]&192)!==128||(r[e+2]&192)!==128||(r[e+3]&192)!==128||r[e]===240&&(r[e+1]&240)===128||r[e]===244&&r[e+1]>143||r[e]>244)return!1;e+=4}else return!1;return!0}Wr.exports={isValidStatusCode:vc,isValidUTF8:Wi,tokenChars:yc};if(So)Wr.exports.isValidUTF8=function(r){return r.length<24?Wi(r):So(r)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let r=S("utf-8-validate");Wr.exports.isValidUTF8=function(t){return t.length<32?Wi(t):r(t)}}catch{}});var Xi=M((Dd,Fo)=>{"use strict";var{Writable:Cc}=S("stream"),ko=Yt(),{BINARY_TYPES:bc,EMPTY_BUFFER:Oo,kStatusCode:Ec,kWebSocket:wc}=Ie(),{concat:$i,toArrayBuffer:xc,unmask:Sc}=$t(),{isValidStatusCode:kc,isValidUTF8:To}=Xt(),$r=Buffer[Symbol.species],re=0,Do=1,Ao=2,Mo=3,zi=4,Ji=5,zr=6,Yi=class extends Cc{constructor(t={}){super(),this._allowSynchronousEvents=t.allowSynchronousEvents!==void 0?t.allowSynchronousEvents:!0,this._binaryType=t.binaryType||bc[0],this._extensions=t.extensions||{},this._isServer=!!t.isServer,this._maxPayload=t.maxPayload|0,this._skipUTF8Validation=!!t.skipUTF8Validation,this[wc]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=re}_write(t,e,i){if(this._opcode===8&&this._state==re)return i();this._bufferedBytes+=t.length,this._buffers.push(t),this.startLoop(i)}consume(t){if(this._bufferedBytes-=t,t===this._buffers[0].length)return this._buffers.shift();if(t<this._buffers[0].length){let i=this._buffers[0];return this._buffers[0]=new $r(i.buffer,i.byteOffset+t,i.length-t),new $r(i.buffer,i.byteOffset,t)}let e=Buffer.allocUnsafe(t);do{let i=this._buffers[0],n=e.length-t;t>=i.length?e.set(this._buffers.shift(),n):(e.set(new Uint8Array(i.buffer,i.byteOffset,t),n),this._buffers[0]=new $r(i.buffer,i.byteOffset+t,i.length-t)),t-=i.length}while(t>0);return e}startLoop(t){this._loop=!0;do switch(this._state){case re:this.getInfo(t);break;case Do:this.getPayloadLength16(t);break;case Ao:this.getPayloadLength64(t);break;case Mo:this.getMask();break;case zi:this.getData(t);break;case Ji:case zr:this._loop=!1;return}while(this._loop);this._errored||t()}getInfo(t){if(this._bufferedBytes<2){this._loop=!1;return}let e=this.consume(2);if(e[0]&48){let n=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");t(n);return}let i=(e[0]&64)===64;if(i&&!this._extensions[ko.extensionName]){let n=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");t(n);return}if(this._fin=(e[0]&128)===128,this._opcode=e[0]&15,this._payloadLength=e[1]&127,this._opcode===0){if(i){let n=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");t(n);return}if(!this._fragmented){let n=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");t(n);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let n=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");t(n);return}this._compressed=i}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let n=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");t(n);return}if(i){let n=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");t(n);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let n=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");t(n);return}}else{let n=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");t(n);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(e[1]&128)===128,this._isServer){if(!this._masked){let n=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");t(n);return}}else if(this._masked){let n=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");t(n);return}this._payloadLength===126?this._state=Do:this._payloadLength===127?this._state=Ao:this.haveLength(t)}getPayloadLength16(t){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(t)}getPayloadLength64(t){if(this._bufferedBytes<8){this._loop=!1;return}let e=this.consume(8),i=e.readUInt32BE(0);if(i>Math.pow(2,21)-1){let n=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");t(n);return}this._payloadLength=i*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength(t)}haveLength(t){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");t(e);return}this._masked?this._state=Mo:this._state=zi}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=zi}getData(t){let e=Oo;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}e=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&Sc(e,this._mask)}if(this._opcode>7){this.controlMessage(e,t);return}if(this._compressed){this._state=Ji,this.decompress(e,t);return}e.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(e)),this.dataMessage(t)}decompress(t,e){this._extensions[ko.extensionName].decompress(t,this._fin,(n,s)=>{if(n)return e(n);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let o=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(o);return}this._fragments.push(s)}this.dataMessage(e),this._state===re&&this.startLoop(e)})}dataMessage(t){if(!this._fin){this._state=re;return}let e=this._messageLength,i=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let n;this._binaryType==="nodebuffer"?n=$i(i,e):this._binaryType==="arraybuffer"?n=xc($i(i,e)):n=i,this._allowSynchronousEvents?(this.emit("message",n,!0),this._state=re):(this._state=zr,setImmediate(()=>{this.emit("message",n,!0),this._state=re,this.startLoop(t)}))}else{let n=$i(i,e);if(!this._skipUTF8Validation&&!To(n)){let s=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");t(s);return}this._state===Ji||this._allowSynchronousEvents?(this.emit("message",n,!1),this._state=re):(this._state=zr,setImmediate(()=>{this.emit("message",n,!1),this._state=re,this.startLoop(t)}))}}controlMessage(t,e){if(this._opcode===8){if(t.length===0)this._loop=!1,this.emit("conclude",1005,Oo),this.end();else{let i=t.readUInt16BE(0);if(!kc(i)){let s=this.createError(RangeError,`invalid status code ${i}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");e(s);return}let n=new $r(t.buffer,t.byteOffset+2,t.length-2);if(!this._skipUTF8Validation&&!To(n)){let s=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(s);return}this._loop=!1,this.emit("conclude",i,n),this.end()}this._state=re;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",t),this._state=re):(this._state=zr,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",t),this._state=re,this.startLoop(e)}))}createError(t,e,i,n,s){this._loop=!1,this._errored=!0;let o=new t(i?`Invalid WebSocket frame: ${e}`:e);return Error.captureStackTrace(o,this.createError),o.code=s,o[Ec]=n,o}};Fo.exports=Yi});var Qi=M((Md,Ro)=>{"use strict";var{Duplex:Ad}=S("stream"),{randomFillSync:Oc}=S("crypto"),Vo=Yt(),{EMPTY_BUFFER:Tc}=Ie(),{isValidStatusCode:Dc}=Xt(),{mask:No,toBuffer:pt}=$t(),oe=Symbol("kByteLength"),Ac=Buffer.alloc(4),Jr=8*1024,ze,mt=Jr,Ki=class r{constructor(t,e,i){this._extensions=e||{},i&&(this._generateMask=i,this._maskBuffer=Buffer.alloc(4)),this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(t,e){let i,n=!1,s=2,o=!1;e.mask&&(i=e.maskBuffer||Ac,e.generateMask?e.generateMask(i):(mt===Jr&&(ze===void 0&&(ze=Buffer.alloc(Jr)),Oc(ze,0,Jr),mt=0),i[0]=ze[mt++],i[1]=ze[mt++],i[2]=ze[mt++],i[3]=ze[mt++]),o=(i[0]|i[1]|i[2]|i[3])===0,s=6);let a;typeof t=="string"?(!e.mask||o)&&e[oe]!==void 0?a=e[oe]:(t=Buffer.from(t),a=t.length):(a=t.length,n=e.mask&&e.readOnly&&!o);let l=a;a>=65536?(s+=8,l=127):a>125&&(s+=2,l=126);let u=Buffer.allocUnsafe(n?a+s:s);return u[0]=e.fin?e.opcode|128:e.opcode,e.rsv1&&(u[0]|=64),u[1]=l,l===126?u.writeUInt16BE(a,2):l===127&&(u[2]=u[3]=0,u.writeUIntBE(a,4,6)),e.mask?(u[1]|=128,u[s-4]=i[0],u[s-3]=i[1],u[s-2]=i[2],u[s-1]=i[3],o?[u,t]:n?(No(t,i,u,s,a),[u]):(No(t,i,t,0,a),[u,t])):[u,t]}close(t,e,i,n){let s;if(t===void 0)s=Tc;else{if(typeof t!="number"||!Dc(t))throw new TypeError("First argument must be a valid error code number");if(e===void 0||!e.length)s=Buffer.allocUnsafe(2),s.writeUInt16BE(t,0);else{let a=Buffer.byteLength(e);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");s=Buffer.allocUnsafe(2+a),s.writeUInt16BE(t,0),typeof e=="string"?s.write(e,2):s.set(e,2)}}let o={[oe]:s.length,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,s,!1,o,n]):this.sendFrame(r.frame(s,o),n)}ping(t,e,i){let n,s;if(typeof t=="string"?(n=Buffer.byteLength(t),s=!1):(t=pt(t),n=t.length,s=pt.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[oe]:n,fin:!0,generateMask:this._generateMask,mask:e,maskBuffer:this._maskBuffer,opcode:9,readOnly:s,rsv1:!1};this._deflating?this.enqueue([this.dispatch,t,!1,o,i]):this.sendFrame(r.frame(t,o),i)}pong(t,e,i){let n,s;if(typeof t=="string"?(n=Buffer.byteLength(t),s=!1):(t=pt(t),n=t.length,s=pt.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[oe]:n,fin:!0,generateMask:this._generateMask,mask:e,maskBuffer:this._maskBuffer,opcode:10,readOnly:s,rsv1:!1};this._deflating?this.enqueue([this.dispatch,t,!1,o,i]):this.sendFrame(r.frame(t,o),i)}send(t,e,i){let n=this._extensions[Vo.extensionName],s=e.binary?2:1,o=e.compress,a,l;if(typeof t=="string"?(a=Buffer.byteLength(t),l=!1):(t=pt(t),a=t.length,l=pt.readOnly),this._firstFragment?(this._firstFragment=!1,o&&n&&n.params[n._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=a>=n._threshold),this._compress=o):(o=!1,s=0),e.fin&&(this._firstFragment=!0),n){let u={[oe]:a,fin:e.fin,generateMask:this._generateMask,mask:e.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:l,rsv1:o};this._deflating?this.enqueue([this.dispatch,t,this._compress,u,i]):this.dispatch(t,this._compress,u,i)}else this.sendFrame(r.frame(t,{[oe]:a,fin:e.fin,generateMask:this._generateMask,mask:e.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:l,rsv1:!1}),i)}dispatch(t,e,i,n){if(!e){this.sendFrame(r.frame(t,i),n);return}let s=this._extensions[Vo.extensionName];this._bufferedBytes+=i[oe],this._deflating=!0,s.compress(t,i.fin,(o,a)=>{if(this._socket.destroyed){let l=new Error("The socket was closed while data was being compressed");typeof n=="function"&&n(l);for(let u=0;u<this._queue.length;u++){let c=this._queue[u],h=c[c.length-1];typeof h=="function"&&h(l)}return}this._bufferedBytes-=i[oe],this._deflating=!1,i.readOnly=!1,this.sendFrame(r.frame(a,i),n),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let t=this._queue.shift();this._bufferedBytes-=t[3][oe],Reflect.apply(t[0],this,t.slice(1))}}enqueue(t){this._bufferedBytes+=t[3][oe],this._queue.push(t)}sendFrame(t,e){t.length===2?(this._socket.cork(),this._socket.write(t[0]),this._socket.write(t[1],e),this._socket.uncork()):this._socket.write(t[0],e)}};Ro.exports=Ki});var Ho=M((Fd,Go)=>{"use strict";var{kForOnEventAttribute:Kt,kListener:Zi}=Ie(),Io=Symbol("kCode"),Po=Symbol("kData"),Lo=Symbol("kError"),Bo=Symbol("kMessage"),Uo=Symbol("kReason"),gt=Symbol("kTarget"),jo=Symbol("kType"),qo=Symbol("kWasClean"),Ee=class{constructor(t){this[gt]=null,this[jo]=t}get target(){return this[gt]}get type(){return this[jo]}};Object.defineProperty(Ee.prototype,"target",{enumerable:!0});Object.defineProperty(Ee.prototype,"type",{enumerable:!0});var Je=class extends Ee{constructor(t,e={}){super(t),this[Io]=e.code===void 0?0:e.code,this[Uo]=e.reason===void 0?"":e.reason,this[qo]=e.wasClean===void 0?!1:e.wasClean}get code(){return this[Io]}get reason(){return this[Uo]}get wasClean(){return this[qo]}};Object.defineProperty(Je.prototype,"code",{enumerable:!0});Object.defineProperty(Je.prototype,"reason",{enumerable:!0});Object.defineProperty(Je.prototype,"wasClean",{enumerable:!0});var _t=class extends Ee{constructor(t,e={}){super(t),this[Lo]=e.error===void 0?null:e.error,this[Bo]=e.message===void 0?"":e.message}get error(){return this[Lo]}get message(){return this[Bo]}};Object.defineProperty(_t.prototype,"error",{enumerable:!0});Object.defineProperty(_t.prototype,"message",{enumerable:!0});var Qt=class extends Ee{constructor(t,e={}){super(t),this[Po]=e.data===void 0?null:e.data}get data(){return this[Po]}};Object.defineProperty(Qt.prototype,"data",{enumerable:!0});var Mc={addEventListener(r,t,e={}){for(let n of this.listeners(r))if(!e[Kt]&&n[Zi]===t&&!n[Kt])return;let i;if(r==="message")i=function(s,o){let a=new Qt("message",{data:o?s:s.toString()});a[gt]=this,Yr(t,this,a)};else if(r==="close")i=function(s,o){let a=new Je("close",{code:s,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[gt]=this,Yr(t,this,a)};else if(r==="error")i=function(s){let o=new _t("error",{error:s,message:s.message});o[gt]=this,Yr(t,this,o)};else if(r==="open")i=function(){let s=new Ee("open");s[gt]=this,Yr(t,this,s)};else return;i[Kt]=!!e[Kt],i[Zi]=t,e.once?this.once(r,i):this.on(r,i)},removeEventListener(r,t){for(let e of this.listeners(r))if(e[Zi]===t&&!e[Kt]){this.removeListener(r,e);break}}};Go.exports={CloseEvent:Je,ErrorEvent:_t,Event:Ee,EventTarget:Mc,MessageEvent:Qt};function Yr(r,t,e){typeof r=="object"&&r.handleEvent?r.handleEvent.call(r,e):r.call(t,e)}});var en=M((Vd,Wo)=>{"use strict";var{tokenChars:Zt}=Xt();function fe(r,t,e){r[t]===void 0?r[t]=[e]:r[t].push(e)}function Fc(r){let t=Object.create(null),e=Object.create(null),i=!1,n=!1,s=!1,o,a,l=-1,u=-1,c=-1,h=0;for(;h<r.length;h++)if(u=r.charCodeAt(h),o===void 0)if(c===-1&&Zt[u]===1)l===-1&&(l=h);else if(h!==0&&(u===32||u===9))c===-1&&l!==-1&&(c=h);else if(u===59||u===44){if(l===-1)throw new SyntaxError(`Unexpected character at index ${h}`);c===-1&&(c=h);let E=r.slice(l,c);u===44?(fe(t,E,e),e=Object.create(null)):o=E,l=c=-1}else throw new SyntaxError(`Unexpected character at index ${h}`);else if(a===void 0)if(c===-1&&Zt[u]===1)l===-1&&(l=h);else if(u===32||u===9)c===-1&&l!==-1&&(c=h);else if(u===59||u===44){if(l===-1)throw new SyntaxError(`Unexpected character at index ${h}`);c===-1&&(c=h),fe(e,r.slice(l,c),!0),u===44&&(fe(t,o,e),e=Object.create(null),o=void 0),l=c=-1}else if(u===61&&l!==-1&&c===-1)a=r.slice(l,h),l=c=-1;else throw new SyntaxError(`Unexpected character at index ${h}`);else if(n){if(Zt[u]!==1)throw new SyntaxError(`Unexpected character at index ${h}`);l===-1?l=h:i||(i=!0),n=!1}else if(s)if(Zt[u]===1)l===-1&&(l=h);else if(u===34&&l!==-1)s=!1,c=h;else if(u===92)n=!0;else throw new SyntaxError(`Unexpected character at index ${h}`);else if(u===34&&r.charCodeAt(h-1)===61)s=!0;else if(c===-1&&Zt[u]===1)l===-1&&(l=h);else if(l!==-1&&(u===32||u===9))c===-1&&(c=h);else if(u===59||u===44){if(l===-1)throw new SyntaxError(`Unexpected character at index ${h}`);c===-1&&(c=h);let E=r.slice(l,c);i&&(E=E.replace(/\\/g,""),i=!1),fe(e,a,E),u===44&&(fe(t,o,e),e=Object.create(null),o=void 0),a=void 0,l=c=-1}else throw new SyntaxError(`Unexpected character at index ${h}`);if(l===-1||s||u===32||u===9)throw new SyntaxError("Unexpected end of input");c===-1&&(c=h);let f=r.slice(l,c);return o===void 0?fe(t,f,e):(a===void 0?fe(e,f,!0):i?fe(e,a,f.replace(/\\/g,"")):fe(e,a,f),fe(t,o,e)),t}function Vc(r){return Object.keys(r).map(t=>{let e=r[t];return Array.isArray(e)||(e=[e]),e.map(i=>[t].concat(Object.keys(i).map(n=>{let s=i[n];return Array.isArray(s)||(s=[s]),s.map(o=>o===!0?n:`${n}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Wo.exports={format:Vc,parse:Fc}});var on=M((Id,ra)=>{"use strict";var Nc=S("events"),Rc=S("https"),Ic=S("http"),Jo=S("net"),Pc=S("tls"),{randomBytes:Lc,createHash:Bc}=S("crypto"),{Duplex:Nd,Readable:Rd}=S("stream"),{URL:tn}=S("url"),Le=Yt(),Uc=Xi(),jc=Qi(),{BINARY_TYPES:$o,EMPTY_BUFFER:Xr,GUID:qc,kForOnEventAttribute:rn,kListener:Gc,kStatusCode:Hc,kWebSocket:W,NOOP:Yo}=Ie(),{EventTarget:{addEventListener:Wc,removeEventListener:$c}}=Ho(),{format:zc,parse:Jc}=en(),{toBuffer:Yc}=$t(),Xc=30*1e3,Xo=Symbol("kAborted"),nn=[8,13],we=["CONNECTING","OPEN","CLOSING","CLOSED"],Kc=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,F=class r extends Nc{constructor(t,e,i){super(),this._binaryType=$o[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Xr,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=r.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,t!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,e===void 0?e=[]:Array.isArray(e)||(typeof e=="object"&&e!==null?(i=e,e=[]):e=[e]),Ko(this,t,e,i)):(this._autoPong=i.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(t){$o.includes(t)&&(this._binaryType=t,this._receiver&&(this._receiver._binaryType=t))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(t,e,i){let n=new Uc({allowSynchronousEvents:i.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation});this._sender=new jc(t,this._extensions,i.generateMask),this._receiver=n,this._socket=t,n[W]=this,t[W]=this,n.on("conclude",eu),n.on("drain",tu),n.on("error",ru),n.on("message",iu),n.on("ping",nu),n.on("pong",su),t.setTimeout&&t.setTimeout(0),t.setNoDelay&&t.setNoDelay(),e.length>0&&t.unshift(e),t.on("close",Zo),t.on("data",Qr),t.on("end",ea),t.on("error",ta),this._readyState=r.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[Le.extensionName]&&this._extensions[Le.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(t,e){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){Q(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===r.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=r.CLOSING,this._sender.close(t,e,!this._isServer,i=>{i||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),Xc)}}pause(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!0,this._socket.pause())}ping(t,e,i){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(i=t,t=e=void 0):typeof e=="function"&&(i=e,e=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==r.OPEN){sn(this,t,i);return}e===void 0&&(e=!this._isServer),this._sender.ping(t||Xr,e,i)}pong(t,e,i){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(i=t,t=e=void 0):typeof e=="function"&&(i=e,e=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==r.OPEN){sn(this,t,i);return}e===void 0&&(e=!this._isServer),this._sender.pong(t||Xr,e,i)}resume(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(t,e,i){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"&&(i=e,e={}),typeof t=="number"&&(t=t.toString()),this.readyState!==r.OPEN){sn(this,t,i);return}let n=k({binary:typeof t!="string",mask:!this._isServer,compress:!0,fin:!0},e);this._extensions[Le.extensionName]||(n.compress=!1),this._sender.send(t||Xr,n,i)}terminate(){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){Q(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=r.CLOSING,this._socket.destroy())}}};Object.defineProperty(F,"CONNECTING",{enumerable:!0,value:we.indexOf("CONNECTING")});Object.defineProperty(F.prototype,"CONNECTING",{enumerable:!0,value:we.indexOf("CONNECTING")});Object.defineProperty(F,"OPEN",{enumerable:!0,value:we.indexOf("OPEN")});Object.defineProperty(F.prototype,"OPEN",{enumerable:!0,value:we.indexOf("OPEN")});Object.defineProperty(F,"CLOSING",{enumerable:!0,value:we.indexOf("CLOSING")});Object.defineProperty(F.prototype,"CLOSING",{enumerable:!0,value:we.indexOf("CLOSING")});Object.defineProperty(F,"CLOSED",{enumerable:!0,value:we.indexOf("CLOSED")});Object.defineProperty(F.prototype,"CLOSED",{enumerable:!0,value:we.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(F.prototype,r,{enumerable:!0})});["open","error","close","message"].forEach(r=>{Object.defineProperty(F.prototype,`on${r}`,{enumerable:!0,get(){for(let t of this.listeners(r))if(t[rn])return t[Gc];return null},set(t){for(let e of this.listeners(r))if(e[rn]){this.removeListener(r,e);break}typeof t=="function"&&this.addEventListener(r,t,{[rn]:!0})}})});F.prototype.addEventListener=Wc;F.prototype.removeEventListener=$c;ra.exports=F;function Ko(r,t,e,i){let n=N(k({allowSynchronousEvents:!0,autoPong:!0,protocolVersion:nn[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10},i),{socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0});if(r._autoPong=n.autoPong,!nn.includes(n.protocolVersion))throw new RangeError(`Unsupported protocol version: ${n.protocolVersion} (supported versions: ${nn.join(", ")})`);let s;if(t instanceof tn)s=t;else try{s=new tn(t)}catch{throw new SyntaxError(`Invalid URL: ${t}`)}s.protocol==="http:"?s.protocol="ws:":s.protocol==="https:"&&(s.protocol="wss:"),r._url=s.href;let o=s.protocol==="wss:",a=s.protocol==="ws+unix:",l;if(s.protocol!=="ws:"&&!o&&!a?l=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:a&&!s.pathname?l="The URL's pathname is empty":s.hash&&(l="The URL contains a fragment identifier"),l){let m=new SyntaxError(l);if(r._redirects===0)throw m;Kr(r,m);return}let u=o?443:80,c=Lc(16).toString("base64"),h=o?Rc.request:Ic.request,f=new Set,E;if(n.createConnection=n.createConnection||(o?Zc:Qc),n.defaultPort=n.defaultPort||u,n.port=s.port||u,n.host=s.hostname.startsWith("[")?s.hostname.slice(1,-1):s.hostname,n.headers=N(k({},n.headers),{"Sec-WebSocket-Version":n.protocolVersion,"Sec-WebSocket-Key":c,Connection:"Upgrade",Upgrade:"websocket"}),n.path=s.pathname+s.search,n.timeout=n.handshakeTimeout,n.perMessageDeflate&&(E=new Le(n.perMessageDeflate!==!0?n.perMessageDeflate:{},!1,n.maxPayload),n.headers["Sec-WebSocket-Extensions"]=zc({[Le.extensionName]:E.offer()})),e.length){for(let m of e){if(typeof m!="string"||!Kc.test(m)||f.has(m))throw new SyntaxError("An invalid or duplicated subprotocol was specified");f.add(m)}n.headers["Sec-WebSocket-Protocol"]=e.join(",")}if(n.origin&&(n.protocolVersion<13?n.headers["Sec-WebSocket-Origin"]=n.origin:n.headers.Origin=n.origin),(s.username||s.password)&&(n.auth=`${s.username}:${s.password}`),a){let m=n.path.split(":");n.socketPath=m[0],n.path=m[1]}let x;if(n.followRedirects){if(r._redirects===0){r._originalIpc=a,r._originalSecure=o,r._originalHostOrSocketPath=a?n.socketPath:s.host;let m=i&&i.headers;if(i=N(k({},i),{headers:{}}),m)for(let[w,q]of Object.entries(m))i.headers[w.toLowerCase()]=q}else if(r.listenerCount("redirect")===0){let m=a?r._originalIpc?n.socketPath===r._originalHostOrSocketPath:!1:r._originalIpc?!1:s.host===r._originalHostOrSocketPath;(!m||r._originalSecure&&!o)&&(delete n.headers.authorization,delete n.headers.cookie,m||delete n.headers.host,n.auth=void 0)}n.auth&&!i.headers.authorization&&(i.headers.authorization="Basic "+Buffer.from(n.auth).toString("base64")),x=r._req=h(n),r._redirects&&r.emit("redirect",r.url,x)}else x=r._req=h(n);n.timeout&&x.on("timeout",()=>{Q(r,x,"Opening handshake has timed out")}),x.on("error",m=>{x===null||x[Xo]||(x=r._req=null,Kr(r,m))}),x.on("response",m=>{let w=m.headers.location,q=m.statusCode;if(w&&n.followRedirects&&q>=300&&q<400){if(++r._redirects>n.maxRedirects){Q(r,x,"Maximum redirects exceeded");return}x.abort();let V;try{V=new tn(w,t)}catch{let y=new SyntaxError(`Invalid URL: ${w}`);Kr(r,y);return}Ko(r,V,e,i)}else r.emit("unexpected-response",x,m)||Q(r,x,`Unexpected server response: ${m.statusCode}`)}),x.on("upgrade",(m,w,q)=>{if(r.emit("upgrade",m),r.readyState!==F.CONNECTING)return;x=r._req=null;let V=m.headers.upgrade;if(V===void 0||V.toLowerCase()!=="websocket"){Q(r,w,"Invalid Upgrade header");return}let d=Bc("sha1").update(c+qc).digest("base64");if(m.headers["sec-websocket-accept"]!==d){Q(r,w,"Invalid Sec-WebSocket-Accept header");return}let y=m.headers["sec-websocket-protocol"],G;if(y!==void 0?f.size?f.has(y)||(G="Server sent an invalid subprotocol"):G="Server sent a subprotocol but none was requested":f.size&&(G="Server sent no subprotocol"),G){Q(r,w,G);return}y&&(r._protocol=y);let I=m.headers["sec-websocket-extensions"];if(I!==void 0){if(!E){Q(r,w,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let Y;try{Y=Jc(I)}catch{Q(r,w,"Invalid Sec-WebSocket-Extensions header");return}let pe=Object.keys(Y);if(pe.length!==1||pe[0]!==Le.extensionName){Q(r,w,"Server indicated an extension that was not requested");return}try{E.accept(Y[Le.extensionName])}catch{Q(r,w,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[Le.extensionName]=E}r.setSocket(w,q,{allowSynchronousEvents:n.allowSynchronousEvents,generateMask:n.generateMask,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation})}),n.finishRequest?n.finishRequest(x,r):x.end()}function Kr(r,t){r._readyState=F.CLOSING,r.emit("error",t),r.emitClose()}function Qc(r){return r.path=r.socketPath,Jo.connect(r)}function Zc(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=Jo.isIP(r.host)?"":r.host),Pc.connect(r)}function Q(r,t,e){r._readyState=F.CLOSING;let i=new Error(e);Error.captureStackTrace(i,Q),t.setHeader?(t[Xo]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(Kr,r,i)):(t.destroy(i),t.once("error",r.emit.bind(r,"error")),t.once("close",r.emitClose.bind(r)))}function sn(r,t,e){if(t){let i=Yc(t).length;r._socket?r._sender._bufferedBytes+=i:r._bufferedAmount+=i}if(e){let i=new Error(`WebSocket is not open: readyState ${r.readyState} (${we[r.readyState]})`);process.nextTick(e,i)}}function eu(r,t){let e=this[W];e._closeFrameReceived=!0,e._closeMessage=t,e._closeCode=r,e._socket[W]!==void 0&&(e._socket.removeListener("data",Qr),process.nextTick(Qo,e._socket),r===1005?e.close():e.close(r,t))}function tu(){let r=this[W];r.isPaused||r._socket.resume()}function ru(r){let t=this[W];t._socket[W]!==void 0&&(t._socket.removeListener("data",Qr),process.nextTick(Qo,t._socket),t.close(r[Hc])),t.emit("error",r)}function zo(){this[W].emitClose()}function iu(r,t){this[W].emit("message",r,t)}function nu(r){let t=this[W];t._autoPong&&t.pong(r,!this._isServer,Yo),t.emit("ping",r)}function su(r){this[W].emit("pong",r)}function Qo(r){r.resume()}function Zo(){let r=this[W];this.removeListener("close",Zo),this.removeListener("data",Qr),this.removeListener("end",ea),r._readyState=F.CLOSING;let t;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(t=r._socket.read())!==null&&r._receiver.write(t),r._receiver.end(),this[W]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",zo),r._receiver.on("finish",zo))}function Qr(r){this[W]._receiver.write(r)||this.pause()}function ea(){let r=this[W];r._readyState=F.CLOSING,r._receiver.end(),this.end()}function ta(){let r=this[W];this.removeListener("error",ta),this.on("error",Yo),r&&(r._readyState=F.CLOSING,this.destroy())}});var na=M((Ld,ia)=>{"use strict";var{tokenChars:ou}=Xt();function au(r){let t=new Set,e=-1,i=-1,n=0;for(n;n<r.length;n++){let o=r.charCodeAt(n);if(i===-1&&ou[o]===1)e===-1&&(e=n);else if(n!==0&&(o===32||o===9))i===-1&&e!==-1&&(i=n);else if(o===44){if(e===-1)throw new SyntaxError(`Unexpected character at index ${n}`);i===-1&&(i=n);let a=r.slice(e,i);if(t.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);t.add(a),e=i=-1}else throw new SyntaxError(`Unexpected character at index ${n}`)}if(e===-1||i!==-1)throw new SyntaxError("Unexpected end of input");let s=r.slice(e,n);if(t.has(s))throw new SyntaxError(`The "${s}" subprotocol is duplicated`);return t.add(s),t}ia.exports={parse:au}});var ha=M((Ud,ua)=>{"use strict";var lu=S("events"),Zr=S("http"),{Duplex:Bd}=S("stream"),{createHash:cu}=S("crypto"),sa=en(),Ye=Yt(),uu=na(),hu=on(),{GUID:du,kWebSocket:fu}=Ie(),pu=/^[+/0-9A-Za-z]{22}==$/,oa=0,aa=1,ca=2,an=class extends lu{constructor(t,e){if(super(),t=k({allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:hu},t),t.port==null&&!t.server&&!t.noServer||t.port!=null&&(t.server||t.noServer)||t.server&&t.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(t.port!=null?(this._server=Zr.createServer((i,n)=>{let s=Zr.STATUS_CODES[426];n.writeHead(426,{"Content-Length":s.length,"Content-Type":"text/plain"}),n.end(s)}),this._server.listen(t.port,t.host,t.backlog,e)):t.server&&(this._server=t.server),this._server){let i=this.emit.bind(this,"connection");this._removeListeners=mu(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(n,s,o)=>{this.handleUpgrade(n,s,o,i)}})}t.perMessageDeflate===!0&&(t.perMessageDeflate={}),t.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=t,this._state=oa}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(t){if(this._state===ca){t&&this.once("close",()=>{t(new Error("The server is not running"))}),process.nextTick(er,this);return}if(t&&this.once("close",t),this._state!==aa)if(this._state=aa,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(er,this):process.nextTick(er,this);else{let e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close(()=>{er(this)})}}shouldHandle(t){if(this.options.path){let e=t.url.indexOf("?");if((e!==-1?t.url.slice(0,e):t.url)!==this.options.path)return!1}return!0}handleUpgrade(t,e,i,n){e.on("error",la);let s=t.headers["sec-websocket-key"],o=t.headers.upgrade,a=+t.headers["sec-websocket-version"];if(t.method!=="GET"){Xe(this,t,e,405,"Invalid HTTP method");return}if(o===void 0||o.toLowerCase()!=="websocket"){Xe(this,t,e,400,"Invalid Upgrade header");return}if(s===void 0||!pu.test(s)){Xe(this,t,e,400,"Missing or invalid Sec-WebSocket-Key header");return}if(a!==8&&a!==13){Xe(this,t,e,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(t)){tr(e,400);return}let l=t.headers["sec-websocket-protocol"],u=new Set;if(l!==void 0)try{u=uu.parse(l)}catch{Xe(this,t,e,400,"Invalid Sec-WebSocket-Protocol header");return}let c=t.headers["sec-websocket-extensions"],h={};if(this.options.perMessageDeflate&&c!==void 0){let f=new Ye(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let E=sa.parse(c);E[Ye.extensionName]&&(f.accept(E[Ye.extensionName]),h[Ye.extensionName]=f)}catch{Xe(this,t,e,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:t.headers[`${a===8?"sec-websocket-origin":"origin"}`],secure:!!(t.socket.authorized||t.socket.encrypted),req:t};if(this.options.verifyClient.length===2){this.options.verifyClient(f,(E,x,m,w)=>{if(!E)return tr(e,x||401,m,w);this.completeUpgrade(h,s,u,t,e,i,n)});return}if(!this.options.verifyClient(f))return tr(e,401)}this.completeUpgrade(h,s,u,t,e,i,n)}completeUpgrade(t,e,i,n,s,o,a){if(!s.readable||!s.writable)return s.destroy();if(s[fu])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>oa)return tr(s,503);let u=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${cu("sha1").update(e+du).digest("base64")}`],c=new this.options.WebSocket(null,void 0,this.options);if(i.size){let h=this.options.handleProtocols?this.options.handleProtocols(i,n):i.values().next().value;h&&(u.push(`Sec-WebSocket-Protocol: ${h}`),c._protocol=h)}if(t[Ye.extensionName]){let h=t[Ye.extensionName].params,f=sa.format({[Ye.extensionName]:[h]});u.push(`Sec-WebSocket-Extensions: ${f}`),c._extensions=t}this.emit("headers",u,n),s.write(u.concat(`\r
`).join(`\r
`)),s.removeListener("error",la),c.setSocket(s,o,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(c),c.on("close",()=>{this.clients.delete(c),this._shouldEmitClose&&!this.clients.size&&process.nextTick(er,this)})),a(c,n)}};ua.exports=an;function mu(r,t){for(let e of Object.keys(t))r.on(e,t[e]);return function(){for(let i of Object.keys(t))r.removeListener(i,t[i])}}function er(r){r._state=ca,r.emit("close")}function la(){this.destroy()}function tr(r,t,e,i){e=e||Zr.STATUS_CODES[t],i=k({Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(e)},i),r.once("finish",r.destroy),r.end(`HTTP/1.1 ${t} ${Zr.STATUS_CODES[t]}\r
`+Object.keys(i).map(n=>`${n}: ${i[n]}`).join(`\r
`)+`\r
\r
`+e)}function Xe(r,t,e,i,n){if(r.listenerCount("wsClientError")){let s=new Error(n);Error.captureStackTrace(s,Xe),r.emit("wsClientError",s,e,t)}else tr(e,i,n)}});var Yn=(()=>{class r{constructor(){this.title="frontend"}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=ce({type:r,selectors:[["app-root"]],standalone:!0,features:[he],decls:1,vars:0,template:function(i,n){i&1&&X(0,"router-outlet")},dependencies:[Wn]})}}return r})();var ss=(()=>{class r{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=n=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static{this.\u0275fac=function(i){return new(i||r)(v(Mt),v(At))}}static{this.\u0275dir=H({type:r})}}return r})(),Ci=(()=>{class r extends ss{static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=Dt(r)))(n||r)}})()}static{this.\u0275dir=H({type:r,features:[ie]})}}return r})(),Bt=new me("");var Ga={provide:Bt,useExisting:Se(()=>Fe),multi:!0};function Ha(){let r=di()?di().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}var Wa=new me(""),Fe=(()=>{class r extends ss{constructor(e,i,n){super(e,i),this._compositionMode=n,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!Ha())}writeValue(e){let i=e??"";this.setProperty("value",i)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static{this.\u0275fac=function(i){return new(i||r)(v(Mt),v(At),v(Wa,8))}}static{this.\u0275dir=H({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,n){i&1&&J("input",function(o){return n._handleInput(o.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(o){return n._compositionEnd(o.target.value)})},features:[Oe([Ga]),ie]})}}return r})();function Ae(r){return r==null||(typeof r=="string"||Array.isArray(r))&&r.length===0}function os(r){return r!=null&&typeof r.length=="number"}var Er=new me(""),bi=new me(""),$a=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,A=class{static min(t){return za(t)}static max(t){return Ja(t)}static required(t){return as(t)}static requiredTrue(t){return Ya(t)}static email(t){return Xa(t)}static minLength(t){return Ka(t)}static maxLength(t){return Qa(t)}static pattern(t){return Za(t)}static nullValidator(t){return pr(t)}static compose(t){return fs(t)}static composeAsync(t){return ms(t)}};function za(r){return t=>{if(Ae(t.value)||Ae(r))return null;let e=parseFloat(t.value);return!isNaN(e)&&e<r?{min:{min:r,actual:t.value}}:null}}function Ja(r){return t=>{if(Ae(t.value)||Ae(r))return null;let e=parseFloat(t.value);return!isNaN(e)&&e>r?{max:{max:r,actual:t.value}}:null}}function as(r){return Ae(r.value)?{required:!0}:null}function Ya(r){return r.value===!0?null:{required:!0}}function Xa(r){return Ae(r.value)||$a.test(r.value)?null:{email:!0}}function Ka(r){return t=>Ae(t.value)||!os(t.value)?null:t.value.length<r?{minlength:{requiredLength:r,actualLength:t.value.length}}:null}function Qa(r){return t=>os(t.value)&&t.value.length>r?{maxlength:{requiredLength:r,actualLength:t.value.length}}:null}function Za(r){if(!r)return pr;let t,e;return typeof r=="string"?(e="",r.charAt(0)!=="^"&&(e+="^"),e+=r,r.charAt(r.length-1)!=="$"&&(e+="$"),t=new RegExp(e)):(e=r.toString(),t=r),i=>{if(Ae(i.value))return null;let n=i.value;return t.test(n)?null:{pattern:{requiredPattern:e,actualValue:n}}}}function pr(r){return null}function ls(r){return r!=null}function cs(r){return Nn(r)?Cn(r):r}function us(r){let t={};return r.forEach(e=>{t=e!=null?k(k({},t),e):t}),Object.keys(t).length===0?null:t}function hs(r,t){return t.map(e=>e(r))}function el(r){return!r.validate}function ds(r){return r.map(t=>el(t)?t:e=>t.validate(e))}function fs(r){if(!r)return null;let t=r.filter(ls);return t.length==0?null:function(e){return us(hs(e,t))}}function ps(r){return r!=null?fs(ds(r)):null}function ms(r){if(!r)return null;let t=r.filter(ls);return t.length==0?null:function(e){let i=hs(e,t).map(cs);return En(i).pipe(ur(us))}}function gs(r){return r!=null?ms(ds(r)):null}function Xn(r,t){return r===null?[t]:Array.isArray(r)?[...r,t]:[r,t]}function _s(r){return r._rawValidators}function ys(r){return r._rawAsyncValidators}function pi(r){return r?Array.isArray(r)?r:[r]:[]}function mr(r,t){return Array.isArray(r)?r.includes(t):r===t}function Kn(r,t){let e=pi(t);return pi(r).forEach(n=>{mr(e,n)||e.push(n)}),e}function Qn(r,t){return pi(t).filter(e=>!mr(r,e))}var gr=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=ps(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=gs(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},qe=class extends gr{get formDirective(){return null}get path(){return null}},Ge=class extends gr{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},_r=class{constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},tl={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},yh=N(k({},tl),{"[class.ng-submitted]":"isSubmitted"}),Ve=(()=>{class r extends _r{constructor(e){super(e)}static{this.\u0275fac=function(i){return new(i||r)(v(Ge,2))}}static{this.\u0275dir=H({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,n){i&2&&ui("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[ie]})}}return r})(),it=(()=>{class r extends _r{constructor(e){super(e)}static{this.\u0275fac=function(i){return new(i||r)(v(qe,10))}}static{this.\u0275dir=H({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,n){i&2&&ui("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)("ng-submitted",n.isSubmitted)},features:[ie]})}}return r})();var Nt="VALID",fr="INVALID",et="PENDING",Rt="DISABLED",Me=class{},yr=class extends Me{constructor(t,e){super(),this.value=t,this.source=e}},It=class extends Me{constructor(t,e){super(),this.pristine=t,this.source=e}},Pt=class extends Me{constructor(t,e){super(),this.touched=t,this.source=e}},tt=class extends Me{constructor(t,e){super(),this.status=t,this.source=e}},mi=class extends Me{constructor(t){super(),this.source=t}},gi=class extends Me{constructor(t){super(),this.source=t}};function Ei(r){return(wr(r)?r.validators:r)||null}function rl(r){return Array.isArray(r)?ps(r):r||null}function wi(r,t){return(wr(t)?t.asyncValidators:r)||null}function il(r){return Array.isArray(r)?gs(r):r||null}function wr(r){return r!=null&&!Array.isArray(r)&&typeof r=="object"}function vs(r,t,e){let i=r.controls;if(!(t?Object.keys(i):i).length)throw new hr(1e3,"");if(!i[e])throw new hr(1001,"")}function Cs(r,t,e){r._forEachChild((i,n)=>{if(e[n]===void 0)throw new hr(1002,"")})}var rt=class{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Vt(()=>this.statusReactive()),this.statusReactive=Ft(void 0),this._pristine=Vt(()=>this.pristineReactive()),this.pristineReactive=Ft(!0),this._touched=Vt(()=>this.touchedReactive()),this.touchedReactive=Ft(!1),this._events=new vn,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return Te(this.statusReactive)}set status(t){Te(()=>this.statusReactive.set(t))}get valid(){return this.status===Nt}get invalid(){return this.status===fr}get pending(){return this.status==et}get disabled(){return this.status===Rt}get enabled(){return this.status!==Rt}get pristine(){return Te(this.pristineReactive)}set pristine(t){Te(()=>this.pristineReactive.set(t))}get dirty(){return!this.pristine}get touched(){return Te(this.touchedReactive)}set touched(t){Te(()=>this.touchedReactive.set(t))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(Kn(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(Kn(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(Qn(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(Qn(t,this._rawAsyncValidators))}hasValidator(t){return mr(this._rawValidators,t)}hasAsyncValidator(t){return mr(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(N(k({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new Pt(!0,i))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=t.sourceControl??this;this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:i})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,i),e&&t.emitEvent!==!1&&this._events.next(new Pt(!1,i))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(N(k({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new It(!1,i))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=t.sourceControl??this;this._forEachChild(n=>{n.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,i),e&&t.emitEvent!==!1&&this._events.next(new It(!0,i))}markAsPending(t={}){this.status=et;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new tt(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(N(k({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Rt,this.errors=null,this._forEachChild(n=>{n.disable(N(k({},t),{onlySelf:!0}))}),this._updateValue();let i=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new yr(this.value,i)),this._events.next(new tt(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(N(k({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(n=>n(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Nt,this._forEachChild(i=>{i.enable(N(k({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(N(k({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Nt||this.status===et)&&this._runAsyncValidator(i,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new yr(this.value,e)),this._events.next(new tt(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(N(k({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Rt:Nt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=et,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let i=cs(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(n=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(n,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((i,n)=>i&&i._find(n),this)}getError(t,e){let i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,i){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||i)&&this._events.next(new tt(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,i)}_initObservables(){this.valueChanges=new Qe,this.statusChanges=new Qe}_calculateStatus(){return this._allControlsDisabled()?Rt:this.errors?fr:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(et)?et:this._anyControlsHaveStatus(fr)?fr:Nt}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let i=!this._anyControlsDirty(),n=this.pristine!==i;this.pristine=i,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),n&&this._events.next(new It(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new Pt(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){wr(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=rl(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=il(this._rawAsyncValidators)}},vr=class extends rt{constructor(t,e,i){super(Ei(e),wi(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){Cs(this,!0,t),Object.keys(t).forEach(i=>{vs(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(i=>{let n=this.controls[i];n&&n.patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,n)=>{i.reset(t?t[n]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>i._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,i]of Object.entries(this.controls))if(this.contains(e)&&t(i))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,i,n)=>((i.enabled||this.disabled)&&(e[n]=i.value),e))}_reduceChildren(t,e){let i=t;return this._forEachChild((n,s)=>{i=e(i,n,s)}),i}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var _i=class extends vr{};var xr=new me("CallSetDisabledState",{providedIn:"root",factory:()=>Sr}),Sr="always";function bs(r,t){return[...t.path,r]}function yi(r,t,e=Sr){xi(r,t),t.valueAccessor.writeValue(r.value),(r.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(r.disabled),sl(r,t),al(r,t),ol(r,t),nl(r,t)}function Zn(r,t,e=!0){let i=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(i),t.valueAccessor.registerOnTouched(i)),br(r,t),r&&(t._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function Cr(r,t){r.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function nl(r,t){if(t.valueAccessor.setDisabledState){let e=i=>{t.valueAccessor.setDisabledState(i)};r.registerOnDisabledChange(e),t._registerOnDestroy(()=>{r._unregisterOnDisabledChange(e)})}}function xi(r,t){let e=_s(r);t.validator!==null?r.setValidators(Xn(e,t.validator)):typeof e=="function"&&r.setValidators([e]);let i=ys(r);t.asyncValidator!==null?r.setAsyncValidators(Xn(i,t.asyncValidator)):typeof i=="function"&&r.setAsyncValidators([i]);let n=()=>r.updateValueAndValidity();Cr(t._rawValidators,n),Cr(t._rawAsyncValidators,n)}function br(r,t){let e=!1;if(r!==null){if(t.validator!==null){let n=_s(r);if(Array.isArray(n)&&n.length>0){let s=n.filter(o=>o!==t.validator);s.length!==n.length&&(e=!0,r.setValidators(s))}}if(t.asyncValidator!==null){let n=ys(r);if(Array.isArray(n)&&n.length>0){let s=n.filter(o=>o!==t.asyncValidator);s.length!==n.length&&(e=!0,r.setAsyncValidators(s))}}}let i=()=>{};return Cr(t._rawValidators,i),Cr(t._rawAsyncValidators,i),e}function sl(r,t){t.valueAccessor.registerOnChange(e=>{r._pendingValue=e,r._pendingChange=!0,r._pendingDirty=!0,r.updateOn==="change"&&Es(r,t)})}function ol(r,t){t.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,r.updateOn==="blur"&&r._pendingChange&&Es(r,t),r.updateOn!=="submit"&&r.markAsTouched()})}function Es(r,t){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function al(r,t){let e=(i,n)=>{t.valueAccessor.writeValue(i),n&&t.viewToModelUpdate(i)};r.registerOnChange(e),t._registerOnDestroy(()=>{r._unregisterOnChange(e)})}function ll(r,t){r==null,xi(r,t)}function cl(r,t){return br(r,t)}function ws(r,t){if(!r.hasOwnProperty("model"))return!1;let e=r.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function ul(r){return Object.getPrototypeOf(r.constructor)===Ci}function hl(r,t){r._syncPendingControls(),t.forEach(e=>{let i=e.control;i.updateOn==="submit"&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function xs(r,t){if(!t)return null;Array.isArray(t);let e,i,n;return t.forEach(s=>{s.constructor===Fe?e=s:ul(s)?i=s:n=s}),n||i||e||null}function dl(r,t){let e=r.indexOf(t);e>-1&&r.splice(e,1)}function es(r,t){let e=r.indexOf(t);e>-1&&r.splice(e,1)}function ts(r){return typeof r=="object"&&r!==null&&Object.keys(r).length===2&&"value"in r&&"disabled"in r}var Lt=class extends rt{constructor(t=null,e,i){super(Ei(e),wi(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),wr(e)&&(e.nonNullable||e.initialValueIsDefault)&&(ts(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){es(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){es(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){ts(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var fl=r=>r instanceof Lt;var pl={provide:Ge,useExisting:Se(()=>Si)},rs=Promise.resolve(),Si=(()=>{class r extends Ge{constructor(e,i,n,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new Lt,this._registered=!1,this.name="",this.update=new Qe,this._parent=e,this._setValidators(i),this._setAsyncValidators(n),this.valueAccessor=xs(this,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),ws(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){yi(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){rs.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let i=e.isDisabled.currentValue,n=i!==0&&hi(i);rs.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?bs(e,this._parent):[e]}static{this.\u0275fac=function(i){return new(i||r)(v(qe,9),v(Er,10),v(bi,10),v(Bt,10),v(In,8),v(xr,8))}}static{this.\u0275dir=H({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Oe([pl]),ie,Tt]})}}return r})(),nt=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275dir=H({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return r})();var Ss=new me("");var ml={provide:qe,useExisting:Se(()=>He)},He=(()=>{class r extends qe{get submitted(){return Te(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}constructor(e,i,n){super(),this.callSetDisabledState=n,this._submitted=Vt(()=>this._submittedReactive()),this._submittedReactive=Ft(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Qe,this._setValidators(e),this._setAsyncValidators(i)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(br(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let i=this.form.get(e.path);return yi(i,e,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),i}getControl(e){return this.form.get(e.path)}removeControl(e){Zn(e.control||null,e,!1),dl(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,i){this.form.get(e.path).setValue(i)}onSubmit(e){return this._submittedReactive.set(!0),hl(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new mi(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this._submittedReactive.set(!1),this.form._events.next(new gi(this.form))}_updateDomValue(){this.directives.forEach(e=>{let i=e.control,n=this.form.get(e.path);i!==n&&(Zn(i||null,e),fl(n)&&(yi(n,e,this.callSetDisabledState),e.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let i=this.form.get(e.path);ll(i,e),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let i=this.form.get(e.path);i&&cl(i,e)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){xi(this.form,this),this._oldForm&&br(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(i){return new(i||r)(v(Er,10),v(bi,10),v(xr,8))}}static{this.\u0275dir=H({type:r,selectors:[["","formGroup",""]],hostBindings:function(i,n){i&1&&J("submit",function(o){return n.onSubmit(o)})("reset",function(){return n.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Oe([ml]),ie,Tt]})}}return r})();var gl={provide:Ge,useExisting:Se(()=>We)},We=(()=>{class r extends Ge{set isDisabled(e){}static{this._ngModelWarningSentOnce=!1}constructor(e,i,n,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new Qe,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(i),this._setAsyncValidators(n),this.valueAccessor=xs(this,s)}ngOnChanges(e){this._added||this._setUpControl(),ws(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return bs(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(i){return new(i||r)(v(qe,13),v(Er,10),v(bi,10),v(Bt,10),v(Ss,8))}}static{this.\u0275dir=H({type:r,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Oe([gl]),ie,Tt]})}}return r})(),_l={provide:Bt,useExisting:Se(()=>st),multi:!0};function ks(r,t){return r==null?`${t}`:(t&&typeof t=="object"&&(t="Object"),`${r}: ${t}`.slice(0,50))}function yl(r){return r.split(":")[0]}var st=(()=>{class r extends Ci{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;let i=this._getOptionId(e),n=ks(i,e);this.setProperty("value",n)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){let i=yl(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=Dt(r)))(n||r)}})()}static{this.\u0275dir=H({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,n){i&1&&J("change",function(o){return n.onChange(o.target.value)})("blur",function(){return n.onTouched()})},inputs:{compareWith:"compareWith"},features:[Oe([_l]),ie]})}}return r})(),kr=(()=>{class r{constructor(e,i,n){this._element=e,this._renderer=i,this._select=n,this._select&&(this.id=this._select._registerOption())}set ngValue(e){this._select!=null&&(this._select._optionMap.set(this.id,e),this._setElementValue(ks(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(i){return new(i||r)(v(At),v(Mt),v(st,9))}}static{this.\u0275dir=H({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return r})(),vl={provide:Bt,useExisting:Se(()=>Os),multi:!0};function is(r,t){return r==null?`${t}`:(typeof t=="string"&&(t=`'${t}'`),t&&typeof t=="object"&&(t="Object"),`${r}: ${t}`.slice(0,50))}function Cl(r){return r.split(":")[0]}var Os=(()=>{class r extends Ci{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;let i;if(Array.isArray(e)){let n=e.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(n.indexOf(o.toString())>-1)}}else i=(n,s)=>{n._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{let n=[],s=i.selectedOptions;if(s!==void 0){let o=s;for(let a=0;a<o.length;a++){let l=o[a],u=this._getOptionValue(l.value);n.push(u)}}else{let o=i.options;for(let a=0;a<o.length;a++){let l=o[a];if(l.selected){let u=this._getOptionValue(l.value);n.push(u)}}}this.value=n,e(n)}}_registerOption(e){let i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){let i=Cl(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=Dt(r)))(n||r)}})()}static{this.\u0275dir=H({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,n){i&1&&J("change",function(o){return n.onChange(o.target)})("blur",function(){return n.onTouched()})},inputs:{compareWith:"compareWith"},features:[Oe([vl]),ie]})}}return r})(),Or=(()=>{class r{constructor(e,i,n){this._element=e,this._renderer=i,this._select=n,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){this._select!=null&&(this._value=e,this._setElementValue(is(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(is(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(i){return new(i||r)(v(At),v(Mt),v(Os,9))}}static{this.\u0275dir=H({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return r})();var bl=(()=>{class r{constructor(){this._validator=pr}ngOnChanges(e){if(this.inputName in e){let i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):pr,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return e!=null}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275dir=H({type:r,features:[Tt]})}}return r})();var El={provide:Er,useExisting:Se(()=>ki),multi:!0};var ki=(()=>{class r extends bl{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=hi,this.createValidator=e=>as}enabled(e){return e}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=Dt(r)))(n||r)}})()}static{this.\u0275dir=H({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,n){i&2&&kn("required",n._enabled?"":null)},inputs:{required:"required"},features:[Oe([El]),ie]})}}return r})();var Ts=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=Ot({type:r})}static{this.\u0275inj=kt({})}}return r})(),vi=class extends rt{constructor(t,e,i){super(Ei(e),wi(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,i={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,e={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,i={}){let n=this._adjustIndex(t);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),e&&(this.controls.splice(n,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){Cs(this,!1,t),t.forEach((i,n)=>{vs(this,!1,n),this.at(n).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(t.forEach((i,n)=>{this.at(n)&&this.at(n).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((i,n)=>{i.reset(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,i)=>i._syncPendingControls()?!0:e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function ns(r){return!!r&&(r.asyncValidators!==void 0||r.validators!==void 0||r.updateOn!==void 0)}var ot=(()=>{class r{constructor(){this.useNonNullable=!1}get nonNullable(){let e=new r;return e.useNonNullable=!0,e}group(e,i=null){let n=this._reduceControls(e),s={};return ns(i)?s=i:i!==null&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new vr(n,s)}record(e,i=null){let n=this._reduceControls(e);return new _i(n,i)}control(e,i,n){let s={};return this.useNonNullable?(ns(i)?s=i:(s.validators=i,s.asyncValidators=n),new Lt(e,N(k({},s),{nonNullable:!0}))):new Lt(e,i,n)}array(e,i,n){let s=e.map(o=>this._createControl(o));return new vi(s,i,n)}_reduceControls(e){let i={};return Object.keys(e).forEach(n=>{i[n]=this._createControl(e[n])}),i}_createControl(e){if(e instanceof Lt)return e;if(e instanceof rt)return e;if(Array.isArray(e)){let i=e[0],n=e.length>1?e[1]:null,s=e.length>2?e[2]:null;return this.control(i,n,s)}else return this.control(e)}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275prov=le({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Tr=(()=>{class r{static withConfig(e){return{ngModule:r,providers:[{provide:xr,useValue:e.callSetDisabledState??Sr}]}}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=Ot({type:r})}static{this.\u0275inj=kt({imports:[Ts]})}}return r})(),at=(()=>{class r{static withConfig(e){return{ngModule:r,providers:[{provide:Ss,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:xr,useValue:e.callSetDisabledState??Sr}]}}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=Ot({type:r})}static{this.\u0275inj=kt({imports:[Ts]})}}return r})();var wl=new me("JWT_OPTIONS"),Ds=(()=>{class r{constructor(e=null){this.tokenGetter=e&&e.tokenGetter||function(){}}urlBase64Decode(e){let i=e.replace(/-/g,"+").replace(/_/g,"/");switch(i.length%4){case 0:break;case 2:{i+="==";break}case 3:{i+="=";break}default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(i)}b64decode(e){let i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="";if(e=String(e).replace(/=+$/,""),e.length%4===1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let s=0,o,a,l=0;a=e.charAt(l++);~a&&(o=s%4?o*64+a:a,s++%4)?n+=String.fromCharCode(255&o>>(-2*s&6)):0)a=i.indexOf(a);return n}b64DecodeUnicode(e){return decodeURIComponent(Array.prototype.map.call(this.b64decode(e),i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(e=this.tokenGetter()){return e instanceof Promise?e.then(i=>this._decodeToken(i)):this._decodeToken(e)}_decodeToken(e){if(!e||e==="")return null;let i=e.split(".");if(i.length!==3)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");let n=this.urlBase64Decode(i[1]);if(!n)throw new Error("Cannot decode the token.");return JSON.parse(n)}getTokenExpirationDate(e=this.tokenGetter()){return e instanceof Promise?e.then(i=>this._getTokenExpirationDate(i)):this._getTokenExpirationDate(e)}_getTokenExpirationDate(e){let i;if(i=this.decodeToken(e),!i||!i.hasOwnProperty("exp"))return null;let n=new Date(0);return n.setUTCSeconds(i.exp),n}isTokenExpired(e=this.tokenGetter(),i){return e instanceof Promise?e.then(n=>this._isTokenExpired(n,i)):this._isTokenExpired(e,i)}_isTokenExpired(e,i){if(!e||e==="")return!0;let n=this.getTokenExpirationDate(e);return i=i||0,n===null?!1:!(n.valueOf()>new Date().valueOf()+i*1e3)}getAuthScheme(e,i){return typeof e=="function"?e(i):e}}return r.\u0275fac=function(e){return new(e||r)(je(wl))},r.\u0275prov=le({token:r,factory:r.\u0275fac}),r})();var lt={api:"apiprod",baseUrl:"https://walrus-app-5txo6.ondigitalocean.app/api",baseUrlSocket:"https://walrus-app-5txo6.ondigitalocean.app/api"};var Ne=(()=>{class r{constructor(e,i){this.http=e,this.router=i,this.apiUrl=lt.baseUrl,this.jwtHelper=new Ds}getLocalStorage(){return typeof localStorage<"u"?localStorage:null}login(e){return this.http.post(`${this.apiUrl}/auth/login`,e).pipe(ur(i=>i&&i.token?(localStorage.setItem("token",i.token),!0):!1),wn(i=>(console.error("Login error",i),bn(!1))))}logout(){localStorage.removeItem("token"),this.router.navigate(["/login"])}isLoggedIn(){let e=this.getLocalStorage(),i=e?e.getItem("token"):null;return!!i&&!this.jwtHelper.isTokenExpired(i)}getCurrentUser(){let e=localStorage.getItem("token");return e?this.jwtHelper.decodeToken(e):null}getToken(){return localStorage.getItem("token")}register(e){return this.http.post(`${this.apiUrl}/auth/register`,e)}static{this.\u0275fac=function(i){return new(i||r)(je(dr),je(de))}}static{this.\u0275prov=le({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Sl(r,t){if(r&1&&(p(0,"div",9),_(1),g()),r&2){let e=ge();C(),ue(e.loginError)}}function kl(r,t){r&1&&(p(0,"div")(1,"small",10),_(2,"Valid email is required"),g()())}function Ol(r,t){r&1&&(p(0,"div")(1,"small",10),_(2,"Password must be at least 6 characters"),g()())}var Ti=(()=>{class r{constructor(e,i,n){this.fb=e,this.authService=i,this.router=n,this.loginError=null,this.loginForm=this.fb.group({email:["",[A.required,A.email]],password:["",[A.required,A.minLength(6)]]})}onSubmit(){this.loginForm.invalid||this.authService.login(this.loginForm.value).subscribe(e=>{e?this.router.navigate(["/tasks"]):this.loginError="Invalid email or password"},e=>{this.loginError="Login failed. Please try again."})}static{this.\u0275fac=function(i){return new(i||r)(v(ot),v(Ne),v(de))}}static{this.\u0275cmp=ce({type:r,selectors:[["app-login"]],standalone:!0,features:[he],decls:15,vars:5,consts:[[1,"login-container"],[3,"ngSubmit","formGroup"],["class","error-message",4,"ngIf"],["for","email"],["id","email","type","email","formControlName","email"],[4,"ngIf"],["for","password"],["id","password","type","password","formControlName","password"],["type","submit",3,"disabled"],[1,"error-message"],[1,"error"]],template:function(i,n){if(i&1&&(p(0,"div",0)(1,"h2"),_(2,"Login"),g(),p(3,"form",1),J("ngSubmit",function(){return n.onSubmit()}),P(4,Sl,2,1,"div",2),p(5,"label",3),_(6,"Email"),g(),X(7,"input",4),P(8,kl,3,0,"div",5),p(9,"label",6),_(10,"Password"),g(),X(11,"input",7),P(12,Ol,3,0,"div",5),p(13,"button",8),_(14,"Login"),g()()()),i&2){let s,o;C(3),O("formGroup",n.loginForm),C(),O("ngIf",n.loginError),C(4),O("ngIf",((s=n.loginForm.get("email"))==null?null:s.invalid)&&((s=n.loginForm.get("email"))==null?null:s.touched)),C(4),O("ngIf",((o=n.loginForm.get("password"))==null?null:o.invalid)&&((o=n.loginForm.get("password"))==null?null:o.touched)),C(),O("disabled",n.loginForm.invalid)}},dependencies:[De,Ze,at,nt,Fe,Ve,it,He,We],styles:[".login-container[_ngcontent-%COMP%]{max-width:400px;margin:3rem auto;padding:2rem;background-color:#f9f9f9;border-radius:8px;box-shadow:0 4px 8px #0000001a;text-align:center}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:1rem}label[_ngcontent-%COMP%]{display:block;margin:.5rem 0 .25rem;color:#555;font-weight:700}input[_ngcontent-%COMP%]{width:100%;padding:.5rem;margin-bottom:1rem;border:1px solid #ccc;border-radius:4px}button[_ngcontent-%COMP%]{width:100%;padding:.75rem;background-color:#4caf50;color:#fff;border:none;border-radius:4px;font-size:1rem;cursor:pointer}button[_ngcontent-%COMP%]:disabled{background-color:#a5d6a7;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{color:#d32f2f;margin-bottom:1rem}"]})}}return r})();var Bi=U(Vs(),1);var ne=Object.create(null);ne.open="0";ne.close="1";ne.ping="2";ne.pong="3";ne.message="4";ne.upgrade="5";ne.noop="6";var Ut=Object.create(null);Object.keys(ne).forEach(r=>{Ut[ne[r]]=r});var jt={type:"error",data:"parser error"};var qt=({type:r,data:t},e,i)=>t instanceof ArrayBuffer||ArrayBuffer.isView(t)?i(e?t:"b"+Ns(t,!0).toString("base64")):i(ne[r]+(t||"")),Ns=(r,t)=>Buffer.isBuffer(r)||r instanceof Uint8Array&&!t?r:r instanceof ArrayBuffer?Buffer.from(r):Buffer.from(r.buffer,r.byteOffset,r.byteLength),Ai;function Rs(r,t){if(r.data instanceof ArrayBuffer||ArrayBuffer.isView(r.data))return t(Ns(r.data,!1));qt(r,!0,e=>{Ai||(Ai=new TextEncoder),t(Ai.encode(e))})}var Gt=(r,t)=>{if(typeof r!="string")return{type:"message",data:Is(r,t)};let e=r.charAt(0);if(e==="b"){let i=Buffer.from(r.substring(1),"base64");return{type:"message",data:Is(i,t)}}return Ut[e]?r.length>1?{type:Ut[e],data:r.substring(1)}:{type:Ut[e]}:jt},Is=(r,t)=>{switch(t){case"arraybuffer":return r instanceof ArrayBuffer?r:Buffer.isBuffer(r)?r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength):r.buffer;case"nodebuffer":default:return Buffer.isBuffer(r)?r:Buffer.from(r)}};var Ps="",Ls=(r,t)=>{let e=r.length,i=new Array(e),n=0;r.forEach((s,o)=>{qt(s,!1,a=>{i[o]=a,++n===e&&t(i.join(Ps))})})},Bs=(r,t)=>{let e=r.split(Ps),i=[];for(let n=0;n<e.length;n++){let s=Gt(e[n],t);if(i.push(s),s.type==="error")break}return i};function Us(){return new TransformStream({transform(r,t){Rs(r,e=>{let i=e.length,n;if(i<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,i);else if(i<65536){n=new Uint8Array(3);let s=new DataView(n.buffer);s.setUint8(0,126),s.setUint16(1,i)}else{n=new Uint8Array(9);let s=new DataView(n.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(i))}r.data&&typeof r.data!="string"&&(n[0]|=128),t.enqueue(n),t.enqueue(e)})}})}var Mi;function Mr(r){return r.reduce((t,e)=>t+e.length,0)}function Fr(r,t){if(r[0].length===t)return r.shift();let e=new Uint8Array(t),i=0;for(let n=0;n<t;n++)e[n]=r[0][i++],i===r[0].length&&(r.shift(),i=0);return r.length&&i<r[0].length&&(r[0]=r[0].slice(i)),e}function js(r,t){Mi||(Mi=new TextDecoder);let e=[],i=0,n=-1,s=!1;return new TransformStream({transform(o,a){for(e.push(o);;){if(i===0){if(Mr(e)<1)break;let l=Fr(e,1);s=(l[0]&128)===128,n=l[0]&127,n<126?i=3:n===126?i=1:i=2}else if(i===1){if(Mr(e)<2)break;let l=Fr(e,2);n=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),i=3}else if(i===2){if(Mr(e)<8)break;let l=Fr(e,8),u=new DataView(l.buffer,l.byteOffset,l.length),c=u.getUint32(0);if(c>Math.pow(2,21)-1){a.enqueue(jt);break}n=c*Math.pow(2,32)+u.getUint32(4),i=3}else{if(Mr(e)<n)break;let l=Fr(e,n);a.enqueue(Gt(s?l:Mi.decode(l),t)),i=0}if(n===0||n>r){a.enqueue(jt);break}}}})}var Fi=4;function D(r){if(r)return Dl(r)}function Dl(r){for(var t in D.prototype)r[t]=D.prototype[t];return r}D.prototype.on=D.prototype.addEventListener=function(r,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(t),this};D.prototype.once=function(r,t){function e(){this.off(r,e),t.apply(this,arguments)}return e.fn=t,this.on(r,e),this};D.prototype.off=D.prototype.removeListener=D.prototype.removeAllListeners=D.prototype.removeEventListener=function(r,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+r];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var i,n=0;n<e.length;n++)if(i=e[n],i===t||i.fn===t){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+r],this};D.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+r],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(e){e=e.slice(0);for(var i=0,n=e.length;i<n;++i)e[i].apply(this,t)}return this};D.prototype.emitReserved=D.prototype.emit;D.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};D.prototype.hasListeners=function(r){return!!this.listeners(r).length};var ye=process.nextTick,z=global,qs="nodebuffer";function Gs(){return new Vi}function Al(r){let t=r.split("; "),e=t[0].indexOf("=");if(e===-1)return;let i=t[0].substring(0,e).trim();if(!i.length)return;let n=t[0].substring(e+1).trim();n.charCodeAt(0)===34&&(n=n.slice(1,-1));let s={name:i,value:n};for(let o=1;o<t.length;o++){let a=t[o].split("=");if(a.length!==2)continue;let l=a[0].trim(),u=a[1].trim();switch(l){case"Expires":s.expires=new Date(u);break;case"Max-Age":let c=new Date;c.setUTCSeconds(c.getUTCSeconds()+parseInt(u,10)),s.expires=c;break;default:}}return s}var Vi=class{constructor(){this._cookies=new Map}parseCookies(t){t&&t.forEach(e=>{let i=Al(e);i&&this._cookies.set(i.name,i)})}get cookies(){let t=Date.now();return this._cookies.forEach((e,i)=>{var n;((n=e.expires)===null||n===void 0?void 0:n.getTime())<t&&this._cookies.delete(i)}),this._cookies.entries()}addCookies(t){let e=[];for(let[i,n]of this.cookies)e.push(`${i}=${n.value}`);e.length&&(t.setDisableHeaderCheck(!0),t.setRequestHeader("cookie",e.join("; ")))}appendCookies(t){for(let[e,i]of this.cookies)t.append("cookie",`${e}=${i.value}`)}};function Vr(r,...t){return t.reduce((e,i)=>(r.hasOwnProperty(i)&&(e[i]=r[i]),e),{})}var Ml=z.setTimeout,Fl=z.clearTimeout;function ve(r,t){t.useNativeTimers?(r.setTimeoutFn=Ml.bind(z),r.clearTimeoutFn=Fl.bind(z)):(r.setTimeoutFn=z.setTimeout.bind(z),r.clearTimeoutFn=z.clearTimeout.bind(z))}var Vl=1.33;function Hs(r){return typeof r=="string"?Nl(r):Math.ceil((r.byteLength||r.size)*Vl)}function Nl(r){let t=0,e=0;for(let i=0,n=r.length;i<n;i++)t=r.charCodeAt(i),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(i++,e+=4);return e}function Nr(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Ws(r){let t="";for(let e in r)r.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(r[e]));return t}function $s(r){let t={},e=r.split("&");for(let i=0,n=e.length;i<n;i++){let s=e[i].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}var no=U(te(),1),ic=(0,no.default)("engine.io-client:transport"),Br=class extends Error{constructor(t,e,i){super(t),this.description=e,this.context=i,this.type="TransportError"}},Ce=class extends D{constructor(t){super(),this.writable=!1,ve(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,i){return super.emitReserved("error",new Br(t,e,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"?this.write(t):ic("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){let e=Gt(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){let t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){let e=Ws(t);return e.length?"?"+e:""}};var so=U(te(),1),se=(0,so.default)("engine.io-client:polling"),Ht=class extends Ce{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";let e=()=>{se("paused"),this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(se("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){se("pre-pause polling complete"),--i||e()})),this.writable||(se("we are currently writing - waiting to pause"),i++,this.once("drain",function(){se("pre-pause writing complete"),--i||e()}))}else e()}_poll(){se("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){se("polling got data %s",t);let e=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};Bs(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"?this._poll():se('ignoring poll - transport state "%s"',this.readyState))}doClose(){let t=()=>{se("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(se("transport open - closing"),t()):(se("transport not open - deferring close"),this.once("open",t))}write(t){this.writable=!1,Ls(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Nr()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}};var oo=!1;try{oo=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var ao=oo;var co=U(te(),1),Li=(0,co.default)("engine.io-client:polling");function nc(){}var Ur=class extends Ht{constructor(t){if(super(t),typeof location<"u"){let e=location.protocol==="https:",i=location.port;i||(i=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,e){let i=this.request({method:"POST",data:t});i.on("success",e),i.on("error",(n,s)=>{this.onError("xhr post error",n,s)})}doPoll(){Li("xhr poll");let t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,i)=>{this.onError("xhr poll error",e,i)}),this.pollXhr=t}},Wt=(()=>{class r extends D{constructor(e,i,n){super(),this.createRequest=e,ve(this,n),this._opts=n,this._method=n.method||"GET",this._uri=i,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;let i=Vr(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");i.xdomain=!!this._opts.xd;let n=this._xhr=this.createRequest(i);try{Li("xhr open %s: %s",this._method,this._uri),n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var s;n.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},Li("xhr data %s",this._data),n.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=r.requestsCount++,r.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=nc,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete r.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}return r.requestsCount=0,r.requests={},r})();if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",lo);else if(typeof addEventListener=="function"){let r="onpagehide"in z?"pagehide":"unload";addEventListener(r,lo,!1)}}function lo(){for(let r in Wt.requests)Wt.requests.hasOwnProperty(r)&&Wt.requests[r].abort()}var _d=function(){let r=sc({xdomain:!1});return r&&r.responseType!==null}();function sc(r){let t=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||ao))return new XMLHttpRequest}catch{}if(!t)try{return new z[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}var oc=Bi.default||Bi,ft=class extends Ur{request(t={}){var e;return Object.assign(t,{xd:this.xd,cookieJar:(e=this.socket)===null||e===void 0?void 0:e._cookieJar},this.opts),new Wt(i=>new oc(i),this.uri(),t)}};var gu=U(po(),1),_u=U(Xi(),1),yu=U(Qi(),1),ln=U(on(),1),vu=U(ha(),1);var da=U(te(),1),Cu=(0,da.default)("engine.io-client:websocket"),bu=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",ei=class extends Ce{get name(){return"websocket"}doOpen(){let t=this.uri(),e=this.opts.protocols,i=bu?{}:Vr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,i)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){let i=t[e],n=e===t.length-1;qt(i,this.supportsBinary,s=>{try{this.doWrite(i,s)}catch{Cu("websocket closed before onclose event")}n&&ye(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=Nr()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}},zd=z.WebSocket||z.MozWebSocket;var yt=class extends ei{createSocket(t,e,i){var n;if(!((n=this.socket)===null||n===void 0)&&n._cookieJar){i.headers=i.headers||{},i.headers.cookie=typeof i.headers.cookie=="string"?[i.headers.cookie]:i.headers.cookie||[];for(let[s,o]of this.socket._cookieJar.cookies)i.headers.cookie.push(`${s}=${o.value}`)}return new ln.default(t,e,i)}doWrite(t,e){let i={};t.options&&(i.compress=t.options.compress),this.opts.perMessageDeflate&&(typeof e=="string"?Buffer.byteLength(e):e.length)<this.opts.perMessageDeflate.threshold&&(i.compress=!1),this.ws.send(e,i)}};var fa=U(te(),1),rr=(0,fa.default)("engine.io-client:webtransport"),vt=class extends Ce{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{rr("transport closed gracefully"),this.onClose()}).catch(t=>{rr("transport closed due to %s",t),this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{let e=js(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(e).getReader(),n=Us();n.readable.pipeTo(t.writable),this._writer=n.writable.getWriter();let s=()=>{i.read().then(({done:a,value:l})=>{if(a){rr("session is closed");return}rr("received chunk: %o",l),this.onPacket(l),s()}).catch(a=>{rr("an error occurred while reading: %s",a)})};s();let o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){let i=t[e],n=e===t.length-1;this._writer.write(i).then(()=>{n&&ye(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}};var cn={websocket:yt,webtransport:vt,polling:ft};var Eu=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,wu=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ct(r){if(r.length>8e3)throw"URI too long";let t=r,e=r.indexOf("["),i=r.indexOf("]");e!=-1&&i!=-1&&(r=r.substring(0,e)+r.substring(e,i).replace(/:/g,";")+r.substring(i,r.length));let n=Eu.exec(r||""),s={},o=14;for(;o--;)s[wu[o]]=n[o]||"";return e!=-1&&i!=-1&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=xu(s,s.path),s.queryKey=Su(s,s.query),s}function xu(r,t){let e=/\/{2,9}/g,i=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function Su(r,t){let e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(e[n]=s)}),e}var pa=U(te(),1),T=(0,pa.default)("engine.io-client:socket"),un=typeof addEventListener=="function"&&typeof removeEventListener=="function",ir=[];un&&addEventListener("offline",()=>{T("closing %d connection(s) because the network was lost",ir.length),ir.forEach(r=>r())},!1);var ti=(()=>{class r extends D{constructor(e,i){if(super(),this.binaryType=qs,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(i=e,e=null),e){let n=Ct(e);i.hostname=n.host,i.secure=n.protocol==="https"||n.protocol==="wss",i.port=n.port,n.query&&(i.query=n.query)}else i.host&&(i.hostname=Ct(i.host).host);ve(this,i),this.secure=i.secure!=null?i.secure:typeof location<"u"&&location.protocol==="https:",i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=i.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},i.transports.forEach(n=>{let s=n.prototype.name;this.transports.push(s),this._transportsByName[s]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=$s(this.opts.query)),un&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(T("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ir.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=Gs()),this._open()}createTransport(e){T('creating transport "%s"',e);let i=Object.assign({},this.opts.query);i.EIO=Fi,i.transport=e,this.id&&(i.sid=this.id);let n=Object.assign({},this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return T("options: %j",n),new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let e=this.opts.rememberUpgrade&&r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";let i=this.createTransport(e);i.open(),this.setTransport(i)}setTransport(e){T("setting transport %s",e.name),this.transport&&(T("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",i=>this._onClose("transport close",i))}onOpen(){T("socket open"),this.readyState="open",r.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(T('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let i=new Error("server error");i.code=e.data,this._onError(i);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}else T('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();T("flushing %d packets in socket",e.length),this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let i=1;for(let n=0;n<this.writeBuffer.length;n++){let s=this.writeBuffer[n].data;if(s&&(i+=Hs(s)),n>0&&i>this._maxPayload)return T("only send %d out of %d packets",n,this.writeBuffer.length),this.writeBuffer.slice(0,n);i+=2}return T("payload size is %d (max: %d)",i,this._maxPayload),this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(T("throttled timer detected, scheduling connection close"),this._pingTimeoutTime=0,ye(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,i,n){return this._sendPacket("message",e,i,n),this}send(e,i,n){return this._sendPacket("message",e,i,n),this}_sendPacket(e,i,n,s){if(typeof i=="function"&&(s=i,i=void 0),typeof n=="function"&&(s=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;let o={type:e,data:i,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),s&&this.once("flush",s),this.flush()}close(){let e=()=>{this._onClose("forced close"),T("socket closing - telling transport to close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),e()},n=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(T("socket error %j",e),r.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return T("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,i){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(T('socket close with reason: "%s"',e),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),un&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let n=ir.indexOf(this._offlineEventListener);n!==-1&&(T("removing listener for the 'offline' event"),ir.splice(n,1))}this.readyState="closed",this.id=null,this.emitReserved("close",e,i),this.writeBuffer=[],this._prevBufferLen=0}}}return r.protocol=Fi,r})(),ri=class extends ti{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade){T("starting upgrade probes");for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}}_probe(t){T('probing transport "%s"',t);let e=this.createTransport(t),i=!1;ti.priorWebsocketSuccess=!1;let n=()=>{i||(T('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",h=>{if(!i)if(h.type==="pong"&&h.data==="probe"){if(T('probe transport "%s" pong',t),this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;ti.priorWebsocketSuccess=e.name==="websocket",T('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{i||this.readyState!=="closed"&&(T("changing transport and sending upgrade packet"),c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{T('probe transport "%s" failed',t);let f=new Error("probe error");f.transport=e.name,this.emitReserved("upgradeError",f)}}))};function s(){i||(i=!0,c(),e.close(),e=null)}let o=h=>{let f=new Error("probe error: "+h);f.transport=e.name,s(),T('probe transport "%s" failed because of error: %s',t,h),this.emitReserved("upgradeError",f)};function a(){o("transport closed")}function l(){o("socket closed")}function u(h){e&&h.name!==e.name&&(T('"%s" works - aborting "%s"',h.name,e.name),s())}let c=()=>{e.removeListener("open",n),e.removeListener("error",o),e.removeListener("close",a),this.off("close",l),this.off("upgrading",u)};e.once("open",n),e.once("error",o),e.once("close",a),this.once("close",l),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){let e=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}},bt=class extends ri{constructor(t,e={}){let i=typeof t=="object"?t:e;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(n=>cn[n]).filter(n=>!!n)),super(t,i)}};var vf=bt.protocol;var ga=U(te(),1),ma=(0,ga.default)("socket.io-client:url");function _a(r,t="",e){let i=r;e=e||typeof location<"u"&&location,r==null&&(r=e.protocol+"//"+e.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=e.protocol+r:r=e.host+r),/^(https?|wss?):\/\//.test(r)||(ma("protocol-less url %s",r),typeof e<"u"?r=e.protocol+"//"+r:r="https://"+r),ma("parse %s",r),i=Ct(r)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+t,i.href=i.protocol+"://"+s+(e&&e.port===i.port?"":":"+i.port),i}var _n={};qa(_n,{Decoder:()=>mn,Encoder:()=>pn,PacketType:()=>b,protocol:()=>wa});var Du=typeof ArrayBuffer=="function",Au=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,ya=Object.prototype.toString,Mu=typeof Blob=="function"||typeof Blob<"u"&&ya.call(Blob)==="[object BlobConstructor]",Fu=typeof File=="function"||typeof File<"u"&&ya.call(File)==="[object FileConstructor]";function sr(r){return Du&&(r instanceof ArrayBuffer||Au(r))||Mu&&r instanceof Blob||Fu&&r instanceof File}function nr(r,t){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let e=0,i=r.length;e<i;e++)if(nr(r[e]))return!0;return!1}if(sr(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return nr(r.toJSON(),!0);for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&nr(r[e]))return!0;return!1}function va(r){let t=[],e=r.data,i=r;return i.data=hn(e,t),i.attachments=t.length,{packet:i,buffers:t}}function hn(r,t){if(!r)return r;if(sr(r)){let e={_placeholder:!0,num:t.length};return t.push(r),e}else if(Array.isArray(r)){let e=new Array(r.length);for(let i=0;i<r.length;i++)e[i]=hn(r[i],t);return e}else if(typeof r=="object"&&!(r instanceof Date)){let e={};for(let i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=hn(r[i],t));return e}return r}function Ca(r,t){return r.data=dn(r.data,t),delete r.attachments,r}function dn(r,t){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<t.length)return t[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let e=0;e<r.length;e++)r[e]=dn(r[e],t);else if(typeof r=="object")for(let e in r)Object.prototype.hasOwnProperty.call(r,e)&&(r[e]=dn(r[e],t));return r}var Ea=U(te(),1),fn=(0,Ea.default)("socket.io-parser"),Vu=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],wa=5,b=function(r){return r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK",r}(b||{}),pn=class{constructor(t){this.replacer=t}encode(t){return fn("encoding packet %j",t),(t.type===b.EVENT||t.type===b.ACK)&&nr(t)?this.encodeAsBinary({type:t.type===b.EVENT?b.BINARY_EVENT:b.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===b.BINARY_EVENT||t.type===b.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),fn("encoded %j as %s",t,e),e}encodeAsBinary(t){let e=va(t),i=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(i),n}};function ba(r){return Object.prototype.toString.call(r)==="[object Object]"}var mn=class r extends D{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);let i=e.type===b.BINARY_EVENT;i||e.type===b.BINARY_ACK?(e.type=i?b.EVENT:b.ACK,this.reconstructor=new gn(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(sr(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0,i={type:Number(t.charAt(0))};if(b[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===b.BINARY_EVENT||i.type===b.BINARY_ACK){let s=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);let o=t.substring(s,e);if(o!=Number(o)||t.charAt(e)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(t.charAt(e+1)==="/"){let s=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););i.nsp=t.substring(s,e)}else i.nsp="/";let n=t.charAt(e+1);if(n!==""&&Number(n)==n){let s=e+1;for(;++e;){let o=t.charAt(e);if(o==null||Number(o)!=o){--e;break}if(e===t.length)break}i.id=Number(t.substring(s,e+1))}if(t.charAt(++e)){let s=this.tryParse(t.substr(e));if(r.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return fn("decoded %s as %j",t,i),i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case b.CONNECT:return ba(e);case b.DISCONNECT:return e===void 0;case b.CONNECT_ERROR:return typeof e=="string"||ba(e);case b.EVENT:case b.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&Vu.indexOf(e[0])===-1);case b.ACK:case b.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},gn=class{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){let e=Ca(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Z(r,t,e){return r.on(t,e),function(){r.off(t,e)}}var xa=U(te(),1),R=(0,xa.default)("socket.io-client:socket"),Nu=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Et=class extends D{constructor(t,e,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let t=this.io;this.subs=[Z(t,"open",this.onopen.bind(this)),Z(t,"packet",this.onpacket.bind(this)),Z(t,"error",this.onerror.bind(this)),Z(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var i,n,s;if(Nu.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;let o={type:b.EVENT,data:e};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){let c=this.ids++;R("emitting packet with ack id %d",c);let h=e.pop();this._registerAckCallback(c,h),o.id=c}let a=(n=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||n===void 0?void 0:n.writable,l=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!a?R("discard packet as the transport is not currently writable"):l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o),this.flags={},this}_registerAckCallback(t,e){var i;let n=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(n===void 0){this.acks[t]=e;return}let s=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&(R("removing packet with ack id %d from the buffer",t),this.sendBuffer.splice(a,1));R("event with ack id %d has timed out after %d ms",t,n),e.call(this,new Error("operation has timed out"))},n),o=(...a)=>{this.io.clearTimeoutFn(s),e.apply(this,a)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...e){return new Promise((i,n)=>{let s=(o,a)=>o?n(o):i(a);s.withError=!0,e.push(s),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());let i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((n,...s)=>i!==this._queue[0]?void 0:(n!==null?i.tryCount>this._opts.retries&&(R("packet [%d] is discarded after %d tries",i.id,i.tryCount),this._queue.shift(),e&&e(n)):(R("packet [%d] was successfully sent",i.id),this._queue.shift(),e&&e(null,...s)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(R("draining queue"),!this.connected||this._queue.length===0)return;let e=this._queue[0];if(e.pending&&!t){R("packet [%d] has already been sent and is waiting for an ack",e.id);return}e.pending=!0,e.tryCount++,R("sending packet [%d] (try n\xB0%d)",e.id,e.tryCount),this.flags=e.flags,this.emit.apply(this,e.args)}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){R("transport is open - connecting"),typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:b.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){R("close (%s)",t),this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){let i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case b.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case b.EVENT:case b.BINARY_EVENT:this.onevent(t);break;case b.ACK:case b.BINARY_ACK:this.onack(t);break;case b.DISCONNECT:this.ondisconnect();break;case b.CONNECT_ERROR:this.destroy();let i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){let e=t.data||[];R("emitting event %j",e),t.id!=null&&(R("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){let e=this._anyListeners.slice();for(let i of e)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){let e=this,i=!1;return function(...n){i||(i=!0,R("sending ack %j",n),e.packet({type:b.ACK,id:t,data:n}))}}onack(t){let e=this.acks[t.id];if(typeof e!="function"){R("bad ack %s",t.id);return}delete this.acks[t.id],R("calling ack %s with %j",t.id,t.data),e.withError&&t.data.unshift(null),e.apply(this,t.data)}onconnect(t,e){R("socket connected with id %s",t),this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){R("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(R("performing disconnect (%s)",this.nsp),this.packet({type:b.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){let e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){let e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let e=this._anyOutgoingListeners.slice();for(let i of e)i.apply(this,t.data)}}};function Ke(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}Ke.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*r);r=Math.floor(t*10)&1?r+e:r-e}return Math.min(r,this.max)|0};Ke.prototype.reset=function(){this.attempts=0};Ke.prototype.setMin=function(r){this.ms=r};Ke.prototype.setMax=function(r){this.max=r};Ke.prototype.setJitter=function(r){this.jitter=r};var Sa=U(te(),1),j=(0,Sa.default)("socket.io-client:manager"),wt=class extends D{constructor(t,e){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,ve(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Ke({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;let n=e.parser||_n;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(j("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;j("opening %s",this.uri),this.engine=new bt(this.uri,this.opts);let e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=Z(e,"open",function(){i.onopen(),t&&t()}),s=a=>{j("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",a),t?t(a):this.maybeReconnectOnOpen()},o=Z(e,"error",s);if(this._timeout!==!1){let a=this._timeout;j("connect attempt will timeout after %d",a);let l=this.setTimeoutFn(()=>{j("connect attempt timed out after %d",a),n(),s(new Error("timeout")),e.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(n),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){j("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let t=this.engine;this.subs.push(Z(t,"ping",this.onping.bind(this)),Z(t,"data",this.ondata.bind(this)),Z(t,"error",this.onerror.bind(this)),Z(t,"close",this.onclose.bind(this)),Z(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){ye(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){j("error",t),this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new Et(this,t,e),this.nsps[t]=i),i}_destroy(t){let e=Object.keys(this.nsps);for(let i of e)if(this.nsps[i].active){j("socket %s is still active, skipping close",i);return}this._close()}_packet(t){j("writing packet %j",t);let e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){j("cleanup"),this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){j("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var i;j("closed due to %s",t),this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)j("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let e=this.backoff.duration();j("will wait %dms before reconnect attempt",e),this._reconnecting=!0;let i=this.setTimeoutFn(()=>{t.skipReconnect||(j("attempting reconnect"),this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(n=>{n?(j("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",n)):(j("reconnect success"),t.onreconnect())}))},e);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){let t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}};var Oa=U(te(),1),ka=(0,Oa.default)("socket.io-client"),or={};function ar(r,t){typeof r=="object"&&(t=r,r=void 0),t=t||{};let e=_a(r,t.path||"/socket.io"),i=e.source,n=e.id,s=e.path,o=or[n]&&s in or[n].nsps,a=t.forceNew||t["force new connection"]||t.multiplex===!1||o,l;return a?(ka("ignoring socket cache for %s",i),l=new wt(i,t)):(or[n]||(ka("new io instance for %s",i),or[n]=new wt(i,t)),l=or[n]),e.query&&!t.query&&(t.query=e.queryKey),l.socket(e.path,t)}Object.assign(ar,{Manager:wt,Socket:Et,io:ar,connect:ar});var Ta=(()=>{class r{constructor(){this.socket=ar(lt.baseUrlSocket)}onTaskCreated(){return new cr(e=>{this.socket.on("taskCreated",i=>{console.log("taskCreated",i),e.next(i)})})}onTaskUpdated(){return new cr(e=>{this.socket.on("taskUpdated",i=>{console.log("onTaskUpdated",i),e.next(i)})})}onTaskDeleted(){return new cr(e=>{this.socket.on("taskDeleted",i=>{console.log("taskDeleted",i),e.next(i)})})}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275prov=le({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var ii=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${lt.baseUrl}/tasks`}createTask(e){return this.http.post(this.apiUrl,e)}getTasks(){return this.http.get(this.apiUrl)}getTasksById(e){return this.http.get(`${this.apiUrl}/${e}`)}updateTask(e,i){return this.http.put(`${this.apiUrl}/${e}`,i)}deleteTask(e){return this.http.delete(`${this.apiUrl}/${e}`)}filterTaskByStatus(e){let i="";return e!="all"&&(i=`?status=${e}`),this.http.get(`${this.apiUrl}/filter${i}`)}static{this.\u0275fac=function(i){return new(i||r)(je(dr))}}static{this.\u0275prov=le({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Ru=()=>["/tasks/add"],Iu=r=>["/tasks/edit",r];function Pu(r,t){if(r&1){let e=On();p(0,"tr")(1,"td"),_(2),g(),p(3,"td"),_(4),g(),p(5,"td"),_(6),g(),p(7,"td")(8,"button",8),_(9,"Edit"),g(),p(10,"button",9),J("click",function(){let n=xn(e).$implicit,s=ge();return Sn(s.deleteTask(n._id))}),_(11,"Delete"),g()()()}if(r&2){let e=t.$implicit;C(2),ue(e.title),C(2),ue(e.description),C(2),ue(e.status),C(2),O("routerLink",Vn(4,Iu,e._id))}}var Aa=(()=>{class r{constructor(e){this.taskService=e,this.tasks=[],this.statusFilter="all",this.socketService=ke(Ta)}ngOnInit(){this.loadTasks(),this.socketService.onTaskCreated().subscribe(e=>{this.tasks.push(e)},e=>{console.log(e)}),this.socketService.onTaskUpdated().subscribe(e=>{console.log("updatedTask",e);let i=this.tasks.findIndex(n=>n._id===e._id);i!==-1&&(this.tasks[i]=e)}),this.socketService.onTaskDeleted().subscribe(e=>{this.tasks=this.tasks.filter(i=>i._id!==e)})}loadTasks(){this.taskService.getTasks().subscribe(e=>{this.tasks=e},e=>{console.log(e)})}deleteTask(e){this.taskService.deleteTask(e).subscribe(()=>{this.tasks=this.tasks.filter(i=>i._id!==e)},i=>{console.log(i)})}applyFilter(){this.taskService.filterTaskByStatus(this.statusFilter).subscribe(e=>{this.tasks=e},e=>{console.log(e)})}static{this.\u0275fac=function(i){return new(i||r)(v(ii))}}static{this.\u0275cmp=ce({type:r,selectors:[["app-task-list"]],standalone:!0,features:[he],decls:26,vars:4,consts:[[1,"task-list"],["for","statusFilter"],["id","statusFilter",3,"ngModelChange","change","ngModel"],["value","all"],["value","pending"],["value","completed"],[1,"add-button",3,"routerLink"],[4,"ngFor","ngForOf"],[3,"routerLink"],[3,"click"]],template:function(i,n){i&1&&(p(0,"div",0)(1,"h2"),_(2,"My Tasks"),g(),p(3,"div")(4,"label",1),_(5,"Filter by Status:"),g(),p(6,"select",2),Mn("ngModelChange",function(o){return An(n.statusFilter,o)||(n.statusFilter=o),o}),J("change",function(){return n.applyFilter()}),p(7,"option",3),_(8,"All"),g(),p(9,"option",4),_(10,"Pending"),g(),p(11,"option",5),_(12,"Completed"),g()()(),p(13,"button",6),_(14,"Add Task"),g(),p(15,"table")(16,"tr")(17,"th"),_(18,"Title"),g(),p(19,"th"),_(20,"Description"),g(),p(21,"th"),_(22,"Status"),g(),p(23,"th"),_(24,"Actions"),g()(),P(25,Pu,12,6,"tr",7),g()()),i&2&&(C(6),Dn("ngModel",n.statusFilter),C(7),O("routerLink",Fn(3,Ru)),C(12),O("ngForOf",n.tasks))},dependencies:[De,Ln,Tr,kr,Or,st,Ve,Si,Jn,$n],styles:[".task-list[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto;padding:1rem;background-color:#f9f9f9;border-radius:8px;box-shadow:0 4px 8px #0000001a}h2[_ngcontent-%COMP%]{text-align:center;color:#333;margin-bottom:1rem}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.75rem;text-align:left;border-bottom:1px solid #ddd}th[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f2f2f2}button[_ngcontent-%COMP%]{margin-right:.5rem;padding:.5rem 1rem;font-size:.9rem;color:#fff;background-color:#4caf50;border:none;border-radius:4px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#45a049}button[_ngcontent-%COMP%]:last-of-type{background-color:#f44336}button[_ngcontent-%COMP%]:last-of-type:hover{background-color:#d32f2f}form[_ngcontent-%COMP%]{display:flex;flex-direction:column}label[_ngcontent-%COMP%]{margin-top:.75rem;color:#333;font-weight:700}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:.5rem;margin-top:.25rem;border:1px solid #ccc;border-radius:4px;font-size:1rem}.add-button[_ngcontent-%COMP%]{margin:inherit}"]})}}return r})();var ni=(r,t)=>{let e=ke(Ne),i=ke(de);return e.isLoggedIn()?!0:(i.navigate(["/login"]),!1)};function Lu(r,t){r&1&&(p(0,"small",13),_(1," Title is required. "),g())}function Bu(r,t){r&1&&(p(0,"small",13),_(1," Title must be at least 5 characters long. "),g())}function Uu(r,t){if(r&1&&(p(0,"div"),P(1,Lu,2,0,"small",12)(2,Bu,2,0,"small",12),g()),r&2){let e,i,n=ge();C(),O("ngIf",(e=n.taskForm.get("title"))==null||e.errors==null?null:e.errors.required),C(),O("ngIf",(i=n.taskForm.get("title"))==null||i.errors==null?null:i.errors.minlength)}}function ju(r,t){r&1&&(p(0,"small",13),_(1," Description is required. "),g())}function qu(r,t){r&1&&(p(0,"small",13),_(1," Description must be at least 10 characters long. "),g())}function Gu(r,t){if(r&1&&(p(0,"div"),P(1,ju,2,0,"small",12)(2,qu,2,0,"small",12),g()),r&2){let e,i,n=ge();C(),O("ngIf",(e=n.taskForm.get("description"))==null||e.errors==null?null:e.errors.required),C(),O("ngIf",(i=n.taskForm.get("description"))==null||i.errors==null?null:i.errors.minlength)}}function Hu(r,t){r&1&&(p(0,"div")(1,"small",13),_(2,"Status is required."),g()())}var yn=(()=>{class r{constructor(e,i,n,s){this.fb=e,this.taskService=i,this.router=n,this.route=s,this.taskId=null,this.taskForm=this.fb.group({title:["",[A.required,A.minLength(5)]],description:["",[A.required,A.minLength(10)]],status:["",[A.required]]})}ngOnInit(){this.taskId=this.route.snapshot.paramMap.get("id"),this.taskId&&this.loadTask(this.taskId)}loadTask(e){this.taskService.getTasksById(e).subscribe(i=>{i&&this.taskForm.patchValue(i)},i=>{console.log(i)})}onSubmit(){if(console.log(this.taskForm.invalid,this.taskForm.value),this.taskForm.invalid)return;let e=k({},this.taskForm.value);this.taskId?this.taskService.updateTask(this.taskId,e).subscribe(()=>{this.router.navigate(["/tasks"])},i=>{console.log(i)}):this.taskService.createTask(e).subscribe(()=>{this.router.navigate(["/tasks"])},i=>{console.log(i)})}static{this.\u0275fac=function(i){return new(i||r)(v(ot),v(ii),v(de),v(Hn))}}static{this.\u0275cmp=ce({type:r,selectors:[["app-task-form"]],standalone:!0,features:[he],decls:22,vars:7,consts:[[1,"task-form"],[3,"ngSubmit","formGroup"],["for","title"],["id","title","formControlName","title","required",""],[4,"ngIf"],["for","description"],["id","description","formControlName","description"],["for","status"],["id","status","formControlName","status"],["value","pending"],["value","completed"],["type","submit",3,"disabled"],["class","error",4,"ngIf"],[1,"error"]],template:function(i,n){if(i&1&&(p(0,"div",0)(1,"h2"),_(2),g(),p(3,"form",1),J("ngSubmit",function(){return n.onSubmit()}),p(4,"label",2),_(5,"Title"),g(),X(6,"input",3),P(7,Uu,3,2,"div",4),p(8,"label",5),_(9,"Description"),g(),X(10,"textarea",6),P(11,Gu,3,2,"div",4),p(12,"label",7),_(13,"Status"),g(),p(14,"select",8)(15,"option",9),_(16,"Pending"),g(),p(17,"option",10),_(18,"Completed"),g()(),P(19,Hu,3,0,"div",4),p(20,"button",11),_(21),g()()()),i&2){let s,o,a;C(2),ue(n.taskId?"Edit Task":"New Task"),C(),O("formGroup",n.taskForm),C(4),O("ngIf",((s=n.taskForm.get("title"))==null?null:s.invalid)&&((s=n.taskForm.get("title"))==null?null:s.touched)),C(4),O("ngIf",((o=n.taskForm.get("description"))==null?null:o.invalid)&&((o=n.taskForm.get("description"))==null?null:o.touched)),C(8),O("ngIf",((a=n.taskForm.get("status"))==null?null:a.invalid)&&((a=n.taskForm.get("status"))==null?null:a.touched)),C(),O("disabled",n.taskForm.invalid),C(),Tn("",n.taskId?"Update":"Create"," Task")}},dependencies:[De,Ze,Tr,nt,kr,Or,Fe,st,Ve,it,ki,at,He,We],styles:[".task-form[_ngcontent-%COMP%]{max-width:600px;margin:2rem auto;padding:1.5rem;background-color:#f9f9f9;border-radius:8px;box-shadow:0 4px 8px #0000001a}h2[_ngcontent-%COMP%]{text-align:center;color:#333;margin-bottom:1rem}form[_ngcontent-%COMP%]{display:flex;flex-direction:column}label[_ngcontent-%COMP%]{margin-top:.75rem;color:#333;font-weight:700}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:.5rem;margin-top:.25rem;border:1px solid #ccc;border-radius:4px;font-size:1rem}textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px}button[_ngcontent-%COMP%]{margin-top:1rem;padding:.75rem;font-size:1rem;color:#fff;background-color:#4caf50;border:none;border-radius:4px;cursor:pointer;align-self:center;width:100%;max-width:200px}button[_ngcontent-%COMP%]:hover{background-color:#45a049}.error-message[_ngcontent-%COMP%]{color:#d32f2f;margin-bottom:1rem}.error[_ngcontent-%COMP%]{color:#d32f2f;font-size:.875em;margin-top:.25rem}input.ng-invalid.ng-touched[_ngcontent-%COMP%], textarea.ng-invalid.ng-touched[_ngcontent-%COMP%], select.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#d32f2f}"]})}}return r})();function Wu(r,t){if(r&1&&(p(0,"div",13),_(1),g()),r&2){let e=ge();C(),ue(e.registrationError)}}function $u(r,t){r&1&&(p(0,"div")(1,"small",14),_(2,"Username is required and must be at least 3 characters"),g()())}function zu(r,t){r&1&&(p(0,"div")(1,"small",14),_(2,"Valid email is required"),g()())}function Ju(r,t){r&1&&(p(0,"div")(1,"small",14),_(2,"Password must be at least 6 characters"),g()())}function Yu(r,t){r&1&&(p(0,"div")(1,"small",14),_(2,"Passwords do not match"),g()())}var Ma=(()=>{class r{constructor(e,i,n){this.fb=e,this.authService=i,this.router=n,this.registrationError=null,this.registerForm=this.fb.group({username:["",[A.required,A.minLength(3)]],email:["",[A.required,A.email]],password:["",[A.required,A.minLength(6)]],confirmPassword:["",[A.required,A.minLength(6)]]})}onSubmit(){if(this.registerForm.invalid)return;let{username:e,email:i,password:n}=this.registerForm.value;this.authService.register({username:e,email:i,password:n}).subscribe(s=>{this.router.navigate(["/login"])},s=>{this.registrationError="Registration failed. Please try again."})}static{this.\u0275fac=function(i){return new(i||r)(v(ot),v(Ne),v(de))}}static{this.\u0275cmp=ce({type:r,selectors:[["app-register"]],standalone:!0,features:[he],decls:23,vars:7,consts:[[1,"register-container"],[3,"ngSubmit","formGroup"],["class","error-message",4,"ngIf"],["for","username"],["id","username","type","text","formControlName","username"],[4,"ngIf"],["for","email"],["id","email","type","email","formControlName","email"],["for","password"],["id","password","type","password","formControlName","password"],["for","confirmPassword"],["id","confirmPassword","type","password","formControlName","confirmPassword"],["type","submit",3,"disabled"],[1,"error-message"],[1,"error"]],template:function(i,n){if(i&1&&(p(0,"div",0)(1,"h2"),_(2,"Register"),g(),p(3,"form",1),J("ngSubmit",function(){return n.onSubmit()}),P(4,Wu,2,1,"div",2),p(5,"label",3),_(6,"Username"),g(),X(7,"input",4),P(8,$u,3,0,"div",5),p(9,"label",6),_(10,"Email"),g(),X(11,"input",7),P(12,zu,3,0,"div",5),p(13,"label",8),_(14,"Password"),g(),X(15,"input",9),P(16,Ju,3,0,"div",5),p(17,"label",10),_(18,"Confirm Password"),g(),X(19,"input",11),P(20,Yu,3,0,"div",5),p(21,"button",12),_(22,"Register"),g()()()),i&2){let s,o,a,l;C(3),O("formGroup",n.registerForm),C(),O("ngIf",n.registrationError),C(4),O("ngIf",((s=n.registerForm.get("username"))==null?null:s.invalid)&&((s=n.registerForm.get("username"))==null?null:s.touched)),C(4),O("ngIf",((o=n.registerForm.get("email"))==null?null:o.invalid)&&((o=n.registerForm.get("email"))==null?null:o.touched)),C(4),O("ngIf",((a=n.registerForm.get("password"))==null?null:a.invalid)&&((a=n.registerForm.get("password"))==null?null:a.touched)),C(4),O("ngIf",((l=n.registerForm.get("confirmPassword"))==null?null:l.value)!==((l=n.registerForm.get("password"))==null?null:l.value)&&((l=n.registerForm.get("confirmPassword"))==null?null:l.touched)),C(),O("disabled",n.registerForm.invalid)}},dependencies:[De,Ze,at,nt,Fe,Ve,it,He,We],styles:[".register-container[_ngcontent-%COMP%]{max-width:400px;margin:3rem auto;padding:2rem;background-color:#f9f9f9;border-radius:8px;box-shadow:0 4px 8px #0000001a;text-align:center}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:1rem}label[_ngcontent-%COMP%]{display:block;margin:.5rem 0 .25rem;color:#555;font-weight:700}input[_ngcontent-%COMP%]{width:100%;padding:.5rem;margin-bottom:1rem;border:1px solid #ccc;border-radius:4px}button[_ngcontent-%COMP%]{width:100%;padding:.75rem;background-color:#4caf50;color:#fff;border:none;border-radius:4px;font-size:1rem;cursor:pointer}button[_ngcontent-%COMP%]:disabled{background-color:#a5d6a7;cursor:not-allowed}.error-message[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{color:#d32f2f;margin-bottom:1rem}"]})}}return r})();var Fa=[{path:"",component:Ti},{path:"login",component:Ti},{path:"register",component:Ma},{path:"tasks",component:Aa,canActivate:[ni]},{path:"tasks/add",component:yn,canActivate:[ni]},{path:"tasks/edit/:id",component:yn,canActivate:[ni]}];var Va=(r,t)=>{let i=ke(Ne).getToken();if(i){let n=r.clone({setHeaders:{Authorization:`Bearer ${i}`}});return t(n)}return t(r)};var Na={providers:[Rn({eventCoalescing:!0}),zn(Fa),qn(),fi(Un()),fi(Bn([Va]))]};var Xu={providers:[Gn()]},Ra=Pn(Na,Xu);var Ku=()=>jn(Yn,Ra),Kp=Ku;export{Js as a,to as b,Kp as c};
